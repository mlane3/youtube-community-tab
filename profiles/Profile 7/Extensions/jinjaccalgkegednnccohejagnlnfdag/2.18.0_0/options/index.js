{const e=this,{window:t}=e,n="expose",l="injectInto",a="runAt",o="scripts",i=e=>"function"==typeof e,s=e=>null!=e&&"object"==typeof e,{Boolean:r,Error:c,Object:u,Promise:d,addEventListener:p,removeEventListener:m,chrome:g,performance:h}=e,{apply:v}=Reflect,f=v.call.bind({}.hasOwnProperty),w=u.call.bind(u.call),b="contextualIdentities"in g,y="#"+o,x=(g.runtime.getURL("/").slice(0,-1),g.runtime.getManifest()),C=(g.runtime.getURL(x.options_ui.page).split("#",1)[0],g.runtime.getURL(x.icons[16].replace("16.png","")),"settings"),_="about",k="recycleBin",S="frameId";(()=>{var v,U,z,D={766:(c,v,U)=>{"use strict";U.d(v,{m:()=>dr}),U(1871);var z=U(5313),D=U(6711),$=U(2477),R=U(5010),j=U(1226),H=(U(3700),U(9994)),E=U(2262),I=U(9518);const W=(0,E.qj)({route:I.BC,canRenderScripts:[o,k,""].includes(I.BC.hash),scripts:[],removedScripts:[],importing:null,loading:!1,needRefresh:!1,storageSize:0,sync:[],title:null});function T(e,t){return(0,z.gj)("MarkRemoved",{id:e.props.id,removed:t})}var O=U(6252),M=U(2502);const A={class:"page-options"},V={key:0},F={class:"aside-content"},L=(0,O._)("img",{src:"/public/images/icon128.png"},null,-1),P=["textContent"],Z=(0,O._)("hr",null,null,-1),Y=["href","data-num-scripts","textContent"];var N=U(7458),B=U(9963);const q={class:"tab-installed",ref:"scroller"},K={key:0},J={class:"flex"},G={key:0,class:"flex flex-auto"},X={class:"btn-ghost",tabindex:"0"},Q=["textContent"],ee=["textContent"],te=["textContent"],ne=["textContent"],le=["textContent"],ae=["value"],oe=["textContent","value"],ie={class:"btn-ghost",tabindex:"0"},se={class:"mr-2c"},re=["placeholder"],ce=["textContent"],ue=["textContent"],de=["textContent"],pe=["textContent"],me={key:0,class:"hint mx-1 my-1 flex flex-col"},ge=["textContent"],he=["textContent"],ve=["textContent"],fe=["data-columns","data-show-order","data-table"];var we=U(5168),be=U(2380),ye=U(392),xe=U(9824),Ce=U(7407),_e=U(6877),ke=U(6653);const Se=".script",Ue=50,ze=20,De=16,$e=500,Re=j.T?{start:"touchstart",move:"touchmove",end:"touchend"}:{start:"dragstart",move:"mousemove",end:"mouseup"},je=j.T&&u.assign(document.createElement("div"),{className:"dragging-noscroll"}),He=["scroll","mouseenter","mouseleave"];let Ee,Ie,We,Te,Oe,Me,Ae,Ve,Fe,Le,Pe,Ze,Ye,Ne,Be,qe,Ke,Je;function Ge(e,t,n){const l=n?p:m;Pe=e,Ze=t,w(l,Pe,Re.start,j.T?tt:at),j.T||(w(l,Pe,"dblclick",Xe,!0),w(l,Pe,"mousedown",Qe,!0),n||et())}function Xe(e){const t=getSelection(),n=e.target.closest(".script-name");n&&(t.removeAllRanges(),t.selectAllChildren(n))}function Qe(e){!e.altKey&&gt(e)&&(Le.draggable=!0),w(p,Pe,"mouseup",et,!0)}function et(){Le&&(Le.draggable=!1),w(m,Pe,"mouseup",et,!0)}function tt(e){gt(e)&&(Me=e,Ae=setTimeout(nt,$e,"timer"),p(Re.move,nt),p(Re.end,lt))}function nt(e){lt(),"timer"===e&&(w(at,Le,Me),b&&rt()&&(Pe.scrollTop+=1,Pe.scrollTop-=1))}function lt(){clearTimeout(Ae),m(Re.move,nt),m(Re.end,lt)}function at(e){var t;if(!gt(e))return;e.cancelable&&e.preventDefault();const{clientX:n,clientY:l}=(null==(t=e.touches)?void 0:t[0])||e,a=Le.getBoundingClientRect(),o=Pe.getBoundingClientRect();Ee=Le.cloneNode(!0),Ie=w([].filter,Pe.children,e=>"none"!==e.style.display),Te=Ie.indexOf(Le),Oe=Te,Ie.splice(Te,1),We=a.height,Ve=n-a.left,Fe=l-a.top,Ye=o.top+Ue,Ne=o.bottom-Ue,Je={},Le.classList.add("dragging-placeholder"),Ee.classList.add("dragging"),Ee.style.transform=`translate(${a.left}px, ${a.top}px)`,Ee.style.width=`${a.width}px`,Pe.appendChild(Ee),j.T&&Pe.insertAdjacentElement("afterBegin",je),p(Re.move,ot),p(Re.end,it)}function ot(e){var t;const{clientX:n,clientY:l,target:a}=(null==(t=e.touches)?void 0:t[0])||e;let o;const i=j.T?mt(n,l):null==a.closest?void 0:a.closest(Se);if(i&&i!==Le){const e=i.getBoundingClientRect(),t=l>e.top+e.height/2;o=Le!==i[(t?"next":"previous")+"ElementSibling"],o&&(i.insertAdjacentElement(t?"afterEnd":"beforeBegin",Le),st(Ie.indexOf(i)+t))}Ee.style.transform=`translate(${n-Ve}px, ${l-Fe}px)`,(ct(l)||o)&&(Je={})}function it(){m(Re.move,ot),m(Re.end,it),dt(),Ee.remove(),j.T&&je.remove(),Le.classList.remove("dragging-placeholder"),Ze(Te,Oe)}function st(e){const t=Oe<e?We:-We,n=Ie.slice(...Oe<e?[Oe,e]:[e,Oe]);n.forEach(e=>{e.style.transition="none",e.style.transform=`translateY(${t}px)`}),setTimeout(()=>n.forEach(({style:e})=>{e.removeProperty("transition"),e.removeProperty("transform")})),Oe=e}function rt(){return Pe.scrollHeight>Pe.clientHeight}function ct(e){const t=rt()&&Math.min(1,Math.max(0,e-Ne,Ye-e)/Ue);return!t&&Be&&dt(),t&&!Be&&(Be=setInterval(ut,De),He.forEach(e=>p(e,pt,!0))),qe=t&&(e>Ne?1:-1)*(1+t*ze|0),Ke=h.now(),!!t}function ut(){const e=h.now(),t=qe*(e-Ke)/De;Pe.scrollTop+=t,Ke=e}function dt(){He.forEach(e=>m(e,pt,!0)),Be&&clearInterval(Be),Be=0}function pt(e){e.stopPropagation()}function mt(e,t){var n;const l=`${e}:${t}`;return Je[l]||(Je[l]=null==(n=document.elementFromPoint(e,t))?void 0:n.closest(Se))}function gt(e){return Le=e.target.closest(Se),Le}const ht=["tabIndex"],vt={class:"script-icon hidden-xs"},ft=["href","data-hotkey"],wt=["src","data-no-icon"],bt={class:"script-name ellipsis"},yt=["textContent","data-order"],xt={class:"script-info flex ml-1c"},Ct=["href","textContent","tabIndex"],_t=["textContent"],kt=["textContent"],St={class:"script-buttons script-buttons-left"},Ut=["href","data-hotkey","tabIndex"],zt=["data-hotkey","tabIndex"],Dt=["data-hotkey","tabIndex"],$t=(0,O._)("span",{class:"sep"},null,-1),Rt=["tabIndex"],jt=["href","tabIndex"],Ht=["textContent","title"],Et={class:"script-buttons script-buttons-right"},It=["data-hotkey","tabIndex"],Wt=["data-hotkey","tabIndex"],Tt={props:["script","visible","viewTable","focused","hotkeys","showHotkeys"],components:{Icon:_e.Z,Tooltip:xe.Z},data(){return{canRender:this.visible}},computed:{showRecycle:()=>W.route.paths[0]===k,author(){const e=this.script.meta.author;if(!e)return;const t=e.match(/^(.*?)\s<(\S*?@\S*?)>$/);return{email:t&&t[2],name:t?t[1]:e}},labelEnable(){return this.script.config.enabled?this.i18n("buttonDisable"):this.i18n("buttonEnable")},description(){return this.script.custom.description||(0,z.iQ)(this.script.meta,"description")},updatedAt(){const{props:e,config:t}=this.script,n={};let l;if(t.removed?({lastModified:l}=e):l=e.lastUpdated||e.lastModified,l){const e=new Date(l);n.show=(0,z.mr)(Date.now()-l),t.removed?n.title=this.i18n("labelRemovedAt",e.toLocaleString()):n.title=this.i18n("labelLastUpdatedAt",e.toLocaleString())}return n},tabIndex(){return this.focused?0:-1},url(){return`#${this.script.config.removed?k:o}/${this.script.props.id}`},urls(){return{home:[(0,z.ag)("buttonHome"),(0,z.t$)(this.script)],question:[(0,z.ag)("buttonSupport"),(0,z.b7)(this.script)]}}},watch:{visible(e){e&&(this.canRender=!0)},focused(e,t){const{$el:n}=this;if(e&&!t&&n){const e=n.getBoundingClientRect(),t=n.parentNode.getBoundingClientRect();let l=0;e.bottom>t.bottom-8?l+=e.bottom-t.bottom+8:e.top<t.top+8&&(l-=t.top-e.top+8),(0,N.u7)(document.activeElement)||n.focus({preventScroll:!0}),this.$emit("scrollDelta",l)}}},methods:{onRemove(){this.$emit("remove",this.script)},onRestore(){this.$emit("restore",this.script)},onToggle(){this.$emit("toggle",this.script)},async onUpdate(){(-1!==this.script.$canUpdate||await(0,j.GW)((0,z.ag)("confirmManualUpdate")))&&this.$emit("update",this.script)},onFocus(){N.$J.setContext("scriptFocus",!0)},onBlur(){N.$J.setContext("scriptFocus",!1)},toggleTip(e){(0,N.xr)(e.target)}}};var Ot=U(3744);const Mt=(0,Ot.Z)(Tt,[["render",(e,t,n,l,a,o)=>{const i=(0,O.up)("icon"),s=(0,O.up)("tooltip");return(0,O.wg)(),(0,O.iD)("div",{class:(0,M.C_)(["script",{disabled:!n.script.config.enabled,removed:n.script.config.removed,error:n.script.error,focused:n.focused,hotkeys:n.focused&&n.showHotkeys}]),tabIndex:o.tabIndex,onFocus:t[5]||(t[5]=(...e)=>o.onFocus&&o.onFocus(...e)),onBlur:t[6]||(t[6]=(...e)=>o.onBlur&&o.onBlur(...e))},[(0,O._)("div",vt,[(0,O._)("a",{href:o.url,"data-hotkey":n.hotkeys.edit,"data-hotkey-table":"",tabIndex:"-1"},[(0,O._)("img",{src:n.script.safeIcon,"data-no-icon":n.script.noIcon},null,8,wt)],8,ft)]),(0,O._)("div",bt,[(0,O._)("a",(0,O.dG)({textContent:(0,M.zw)(n.script.$cache.name)},n.viewTable&&{draggable:!1,href:o.url,tabIndex:o.tabIndex},{"data-order":n.script.config.removed?null:n.script.props.position,class:"ellipsis"}),null,16,yt)]),(0,O._)("div",xt,[a.canRender?((0,O.wg)(),(0,O.iD)(O.HY,{key:0},[o.author?((0,O.wg)(),(0,O.j4)(s,{key:0,content:e.i18n("labelAuthor")+n.script.meta.author,class:"script-author ml-1c hidden-sm",align:"end"},{default:(0,O.w5)(()=>[(0,O.Wm)(i,{name:"author"}),o.author.email?((0,O.wg)(),(0,O.iD)("a",{key:0,class:"ellipsis",href:`mailto:${o.author.email}`,textContent:(0,M.zw)(o.author.name),tabIndex:o.tabIndex},null,8,Ct)):((0,O.wg)(),(0,O.iD)("span",{key:1,class:"ellipsis",textContent:(0,M.zw)(o.author.name)},null,8,_t))]),_:1},8,["content"])):(0,O.kq)("",!0),(0,O._)("span",{class:"version ellipsis",textContent:(0,M.zw)(n.script.meta.version)},null,8,kt),n.script.config.removed?(0,O.kq)("",!0):((0,O.wg)(),(0,O.j4)(s,{key:1,class:"size hidden-sm",content:n.script.$cache.sizes,align:"end"},{default:(0,O.w5)(()=>[(0,O.Uk)((0,M.zw)(n.script.$cache.size),1)]),_:1},8,["content"])),(0,O.Wm)(s,{class:"updated hidden-sm ml-1c",content:o.updatedAt.title,align:"end"},{default:(0,O.w5)(()=>[(0,O.Uk)((0,M.zw)(o.updatedAt.show),1)]),_:1},8,["content"])],64)):(0,O.kq)("",!0)]),(0,O._)("div",St,[a.canRender?((0,O.wg)(),(0,O.iD)(O.HY,{key:0},[(0,O.Wm)(s,{content:e.i18n("buttonEdit"),align:"start"},{default:(0,O.w5)(()=>[(0,O._)("a",{class:"btn-ghost",href:o.url,"data-hotkey":n.hotkeys.edit,tabIndex:o.tabIndex},[(0,O.Wm)(i,{name:"code"})],8,Ut)]),_:1},8,["content"]),n.script.config.removed?(0,O.kq)("",!0):((0,O.wg)(),(0,O.iD)(O.HY,{key:0},[(0,O.Wm)(s,{content:o.labelEnable,align:"start"},{default:(0,O.w5)(()=>[(0,O._)("a",{class:"btn-ghost",onClick:t[0]||(t[0]=(...e)=>o.onToggle&&o.onToggle(...e)),"data-hotkey":n.hotkeys.toggle,tabIndex:o.tabIndex},[(0,O.Wm)(i,{name:"toggle-"+(n.script.config.enabled?"on":"off")},null,8,["name"])],8,zt)]),_:1},8,["content"]),(0,O.Wm)(s,{disabled:!n.script.$canUpdate||n.script.checking,content:e.i18n("buttonCheckForUpdates"),align:"start"},{default:(0,O.w5)(()=>[(0,O._)("a",{class:"btn-ghost",onClick:t[1]||(t[1]=(...e)=>o.onUpdate&&o.onUpdate(...e)),"data-hotkey":n.hotkeys.update,tabIndex:n.script.$canUpdate?o.tabIndex:-1},[(0,O.Wm)(i,{name:"refresh","^invert":-1===n.script.$canUpdate?"":null},null,8,["^invert"])],8,Dt)]),_:1},8,["disabled","content"])],64)),$t,(0,O.Wm)(s,{disabled:!o.description,content:o.description,align:"start"},{default:(0,O.w5)(()=>[(0,O._)("a",{class:"btn-ghost",tabIndex:o.description?o.tabIndex:-1,onClick:t[2]||(t[2]=(...e)=>o.toggleTip&&o.toggleTip(...e))},[(0,O.Wm)(i,{name:"info"})],8,Rt)]),_:1},8,["disabled","content"]),((0,O.wg)(!0),(0,O.iD)(O.HY,null,(0,O.Ko)(o.urls,([e,t],n)=>((0,O.wg)(),(0,O.j4)(s,{key:n,disabled:!t,content:e,align:"start"},{default:(0,O.w5)(()=>[(0,O._)("a",{class:"btn-ghost",target:"_blank",rel:"noopener noreferrer",href:t,tabIndex:t?o.tabIndex:-1},[(0,O.Wm)(i,{name:n},null,8,["name"])],8,jt)]),_:2},1032,["disabled","content"]))),128)),n.script.message?((0,O.wg)(),(0,O.iD)("div",{key:1,class:"script-message",textContent:(0,M.zw)(n.script.message),title:n.script.error},null,8,Ht)):(0,O.kq)("",!0)],64)):(0,O.kq)("",!0)]),(0,O._)("div",Et,[a.canRender?((0,O.wg)(),(0,O.iD)(O.HY,{key:0},[o.showRecycle||!n.script.config.removed?((0,O.wg)(),(0,O.j4)(s,{key:0,content:e.i18n("buttonRemove"),align:"end"},{default:(0,O.w5)(()=>[(0,O._)("a",{class:(0,M.C_)(["btn-ghost",{"btn-danger":n.script.config.removed}]),onClick:t[3]||(t[3]=(...e)=>o.onRemove&&o.onRemove(...e)),"data-hotkey":n.hotkeys.remove,tabIndex:o.tabIndex},[(0,O.Wm)(i,{name:"trash"})],10,It)]),_:1},8,["content"])):(0,O.kq)("",!0),n.script.config.removed?((0,O.wg)(),(0,O.j4)(s,{key:1,content:e.i18n("buttonRestore"),placement:"left"},{default:(0,O.w5)(()=>[(0,O._)("a",{class:"btn-ghost",onClick:t[4]||(t[4]=(...e)=>o.onRestore&&o.onRestore(...e)),"data-hotkey":n.hotkeys.restore,tabIndex:o.tabIndex},[(0,O.Wm)(i,{name:"undo"})],8,Wt)]),_:1},8,["content"])):(0,O.kq)("",!0)],64)):(0,O.kq)("",!0)])],42,ht)}]]),At=Mt;var Vt=U(8599),Ft=U(6115),Lt=U(715);const Pt={class:"form-group condensed"},Zt=["textContent"],Yt=["textContent"],Nt=["textContent"],Bt=["disabled"],qt=["textContent"],Kt=["textContent"],Jt={__name:"settings-update",props:{script:u},setup(e){const t=e,n=(0,O.Fl)(()=>t.script.config),l=(0,O.Fl)(()=>!t.script._remote);return(e,t)=>((0,O.wg)(),(0,O.iD)("div",null,[(0,O._)("div",Pt,[(0,O._)("label",null,[(0,O.wy)((0,O._)("input",(0,O.dG)({type:"checkbox","onUpdate:modelValue":t[0]||(t[0]=e=>n.value.shouldUpdate=e)},{disabled:l.value}),null,16),[[B.e8,n.value.shouldUpdate]]),(0,O._)("span",{textContent:(0,M.zw)(e.i18n("labelAllowUpdate"))},null,8,Zt),(0,O._)("span",{textContent:(0,M.zw)(e.i18n("labelNotifyThisUpdated")),class:"melt"},null,8,Yt)]),((0,O.wg)(!0),(0,O.iD)(O.HY,null,(0,O.Ko)([[e.i18n("genericOn"),"1"],[e.i18n("genericOff"),"0"],[e.i18n("genericUseGlobal"),""]],([e,a])=>((0,O.wg)(),(0,O.iD)("label",{class:"ml-1 melt",key:a},[(0,O.wy)((0,O._)("input",(0,O.dG)({type:"radio"},{value:a,disabled:l.value},{"onUpdate:modelValue":t[1]||(t[1]=e=>n.value.notifyUpdates=e)}),null,16),[[B.G2,n.value.notifyUpdates]]),(0,O.Uk)(),(0,O._)("span",{textContent:(0,M.zw)(e)},null,8,Nt)]))),128))]),(0,O._)("label",null,[(0,O.wy)((0,O._)("input",{type:"checkbox","onUpdate:modelValue":t[2]||(t[2]=e=>n.value._editable=e),class:"scary-switch",disabled:l.value||!n.value.shouldUpdate},null,8,Bt),[[B.e8,n.value._editable]]),(0,O._)("span",{textContent:(0,M.zw)(e.i18n("readonlyOpt"))},null,8,qt),(0,O.Uk)(),(0,O._)("span",{textContent:(0,M.zw)(e.i18n("readonlyOptWarn"))},null,8,Kt)])]))}},Gt={class:"edit-settings"},Xt=["textContent"],Qt={class:"mb-2"},en=["textContent"],tn=["textContent"],nn=(0,O._)("td",null,[(0,O._)("code",null,"@run-at")],-1),ln=["textContent"],an=["disabled"],on=["textContent"],sn=(0,O._)("option",{value:"document-start"},"document-start",-1),rn=(0,O._)("option",{value:"document-body"},"document-body",-1),cn=(0,O._)("option",{value:"document-end"},"document-end",-1),un=(0,O._)("option",{value:"document-idle"},"document-idle",-1),dn=(0,O._)("td",null,[(0,O._)("code",null,[(0,O.Uk)("@"),(0,O._)("s",{style:{color:"var(--fill-6)"}},"no"),(0,O.Uk)("frames")])],-1),pn=["textContent"],mn=["disabled"],gn=["textContent"],hn=["textContent"],vn=["textContent"],fn=(0,O._)("td",null,[(0,O._)("code",null,"@inject-into")],-1),wn=["textContent"],bn=["disabled"],yn=["textContent"],xn=["textContent"],Cn=["textContent"],_n=["textContent"],kn=["onUpdate:modelValue","placeholder","disabled"],Sn=["textContent"],Un=["textContent"],zn=["textContent"],Dn=["onUpdate:modelValue","disabled"],$n=["textContent"],Rn=["onUpdate:modelValue","rows","disabled"],jn="downloadURL",Hn="homepageURL",En="updateURL",In={__name:"settings",props:{script:u,readOnly:r},setup(e){const t=e,n=(0,E.XI)(Lt.Wg),l=e=>{var t;return(null==(t=e.match(/^(.*?)(@[-a-z]+)(.*)/))?void 0:t.slice(1))||[e,"",""]},a=(0,O.Fl)(()=>t.script.config),o=(0,O.Fl)(()=>t.script.custom),i=(0,O.Fl)(()=>{const{script:e}=t,{meta:n}=e;return{name:n.name,[Hn]:(0,z.t$)(e),[En]:n[En]||(0,z.ag)("hintUseDownloadURL"),[jn]:n[jn]||e.custom.lastInstallURL}}),s=[["name",(0,z.ag)("labelName")],[Hn,(0,z.ag)("labelHomepageURL")],[En,(0,z.ag)("labelUpdateURL")],[jn,(0,z.ag)("labelDownloadURL")]],r=[["include","origInclude",...l((0,z.ag)("labelInclude"))],["match","origMatch",...l((0,z.ag)("labelMatch"))],["exclude","origExclude",...l((0,z.ag)("labelExclude"))],["excludeMatch","origExcludeMatch",...l((0,z.ag)("labelExcludeMatch"))]];return(t,l)=>((0,O.wg)(),(0,O.iD)("div",Gt,[(0,O._)("h4",{textContent:(0,M.zw)((0,E.SU)(z.ag)("editLabelSettings"))},null,8,Xt),(0,O._)("div",Qt,[(0,O._)("label",null,[(0,O.wy)((0,O._)("input",{type:"checkbox","onUpdate:modelValue":l[0]||(l[0]=e=>a.value.enabled=e)},null,512),[[B.e8,a.value.enabled]]),(0,O._)("span",{textContent:(0,M.zw)((0,E.SU)(z.ag)("buttonEnable"))},null,8,en)])]),(0,O.Wm)((0,E.SU)(Jt),(0,M.vs)((0,O.F4)({script:e.script})),null,16),(0,O._)("h4",{textContent:(0,M.zw)((0,E.SU)(z.ag)("editLabelMeta"))},null,8,tn),(0,O._)("table",null,[(0,O._)("tr",null,[nn,(0,O._)("td",null,[(0,O._)("p",{textContent:(0,M.zw)((0,E.SU)(z.ag)("labelRunAt"))},null,8,ln)]),(0,O._)("td",null,[(0,O.wy)((0,O._)("select",{"onUpdate:modelValue":l[1]||(l[1]=e=>o.value.runAt=e),disabled:e.readOnly},[(0,O._)("option",{value:"",textContent:(0,M.zw)((0,E.SU)(z.ag)("labelRunAtDefault"))},null,8,on),sn,rn,cn,un],8,an),[[B.bM,o.value.runAt]])])]),(0,O._)("tr",null,[dn,(0,O._)("td",null,[(0,O._)("p",{textContent:(0,M.zw)((0,E.SU)(z.ag)("labelNoFrames"))},null,8,pn)]),(0,O._)("td",null,[(0,O.wy)((0,O._)("select",{"onUpdate:modelValue":l[2]||(l[2]=e=>o.value.noframes=e),disabled:e.readOnly},[(0,O._)("option",{value:"",textContent:(0,M.zw)((0,E.SU)(z.ag)("labelRunAtDefault"))},null,8,gn),(0,O._)("option",{value:"0",textContent:(0,M.zw)((0,E.SU)(z.ag)("genericOn"))},null,8,hn),(0,O._)("option",{value:"1",textContent:(0,M.zw)((0,E.SU)(z.ag)("genericOff"))},null,8,vn)],8,mn),[[B.bM,o.value.noframes]])])]),(0,O._)("tr",null,[fn,(0,O._)("td",null,[(0,O._)("p",{textContent:(0,M.zw)((0,E.SU)(z.ag)("labelInjectionMode"))},null,8,wn)]),(0,O._)("td",null,[(0,O.wy)((0,O._)("select",{"onUpdate:modelValue":l[3]||(l[3]=e=>o.value.injectInto=e),disabled:e.readOnly},[(0,O._)("option",{value:"",textContent:(0,M.zw)((0,E.SU)(z.ag)("labelRunAtDefault"))},null,8,yn),((0,O.wg)(!0),(0,O.iD)(O.HY,null,(0,O.Ko)(n.value,(e,t)=>((0,O.wg)(),(0,O.iD)("option",{key:t,textContent:(0,M.zw)(t)},null,8,xn))),128))],8,bn),[[B.bM,o.value.injectInto]])])]),((0,O.wg)(),(0,O.iD)(O.HY,null,(0,O.Ko)(s,([t,n])=>(0,O._)("tr",{key:t},[(0,O._)("td",null,[(0,O._)("code",{textContent:(0,M.zw)(`@${t}`)},null,8,Cn)]),(0,O._)("td",null,[(0,O._)("p",{textContent:(0,M.zw)(n)},null,8,_n)]),(0,O._)("td",null,[(0,O.wy)((0,O._)("input",{type:"text","onUpdate:modelValue":e=>o.value[t]=e,placeholder:i.value[t],disabled:e.readOnly},null,8,kn),[[B.nr,o.value[t]]])])])),64))]),(0,O._)("table",null,[((0,O.wg)(),(0,O.iD)(O.HY,null,(0,O.Ko)(r,([n,l,a,i,s])=>(0,O._)("tr",{key:n},[(0,O._)("td",null,[(0,O._)("p",null,[(0,O._)("span",{textContent:(0,M.zw)(a)},null,8,Sn),(0,O._)("code",{textContent:(0,M.zw)(i)},null,8,Un),(0,O._)("span",{textContent:(0,M.zw)(s)},null,8,zn)]),(0,O._)("label",null,[(0,O.wy)((0,O._)("input",{type:"checkbox","onUpdate:modelValue":e=>o.value[l]=e,disabled:e.readOnly},null,8,Dn),[[B.e8,o.value[l]]]),(0,O._)("span",{textContent:(0,M.zw)((0,E.SU)(z.ag)("labelKeepOriginal"))},null,8,$n)])]),(0,O._)("td",null,[(0,O.wy)((0,O._)("textarea",{"onUpdate:modelValue":e=>o.value[n]=e,spellcheck:"false",rows:t.calcRows(o.value[n]),disabled:e.readOnly},null,8,Rn),[[B.nr,o.value[n]]])])])),64))])]))}},Wn=["data-editing"],Tn={class:"mb-1"},On={key:1,class:"inline-block ml-2"},Mn=["disabled"],An=["textContent"],Vn=["textContent"],Fn=["disabled"],Ln={class:"ml-2 mr-2c"},Pn=(0,O._)("kbd",null,"PageUp",-1),Zn=(0,O._)("kbd",null,"PageDown",-1),Yn=(0,O._)("kbd",null,"\u2191",-1),Nn=(0,O._)("kbd",null,"\u2193",-1),Bn=(0,O._)("kbd",null,"Tab",-1),qn=(0,O._)("kbd",null,"Shift-Tab",-1),Kn=(0,O._)("kbd",null,"Enter",-1),Jn=(0,O._)("kbd",null,"Ctrl-Del",-1),Gn=["onKeydown"],Xn=["textContent"],Qn=["onKeydown","onClick"],el={class:"ellipsis"},tl=["textContent"],nl=["textContent"],ll=["textContent"],al=["onClick"],ol=["textContent"],il=["onKeydown"],sl=["onClick"],rl=["textContent"],cl=["textContent"],ul=["textContent"],dl=["textContent"],pl={key:3,class:"edit-values-panel flex flex-col mb-1c"},ml={class:"control"},gl=["textContent"],hl=["textContent","onClick","title","disabled"],vl=["textContent"],fl=["textContent"],wl=["readOnly","onKeydown"],bl=["textContent"],yl={__name:"values",props:{script:u,readOnly:r},setup(e){const t=e,n=(0,E.iH)(),l=(0,E.iH)(),a=(0,E.iH)(),o=(0,E.iH)(),i=(0,E.iH)(),s=(0,E.iH)(),r=(0,E.iH)(!0),c=(0,E.iH)(),d=(0,E.iH)(),v=(0,E.iH)(),f={error:"",dirty:!1},b=e=>e.length>1024?e.slice(0,1024):e,y=e=>{try{return JSON.stringify(JSON.parse(e),null,"  ")}catch(t){return e}},x={condition:"!edit"},C=e=>N.$J.setContext("edit","selectionEnd"in e.target),_=(0,O.Fl)(()=>u.keys(d.value||{}).sort()),k=(0,O.Fl)(()=>Math.ceil(_.value.length/25)),U=(0,O.Fl)(()=>{const e=25*(c.value-1);return _.value.slice(e,e+25)});let D,$,R,H,I;function T(e){(0,O.Y3)(()=>{l.value[e?"click":"focus"]()})}function A(e){c.value=Math.max(1,Math.min(k.value,c.value+e))}function V(e,t){const n=e.length+(d.value[e]||t).length-1;return n<1e4?n:(0,z.aj)(n)}function F(e,t,n){let l=d.value[e]||n;const a=l[0];return l=l.slice(1),"s"===a?l=JSON.stringify(l):t||(l=y(l)),t?b(l):l}function L(){return`{\n  ${_.value.map(e=>`${JSON.stringify(e)}: ${F(e)}`).join(",\n").replace(/\n/g,"\n  ")}\n}`}function P(e={}){if(!(0,be.vZ)(d.value,e))return d.value=e,c.value=Math.min(c.value,k.value)||1,Z(),!0}function Z(){W.storageSize=_.value.reduce((e,t)=>e+t.length+4+d.value[t].length+2,2)}async function Y({key:e,jsonValue:n,rawValue:l=(0,z.bd)(n)||""}){const{id:a}=t.script.props;await(0,z.gj)("UpdateValue",{id:a,key:e,raw:l},void 0,H),l?d.value[e]=l:delete d.value[e],Z()}function q(){s.value={isNew:!0,key:"",value:"",...f}}async function K(e){var t;Y({key:e}),(v.value||(v.value={}))[e+Math.random()]={key:e,rawValue:d.value[e],cut:F(e,!0),len:V(e)},(null==(t=s.value)?void 0:t.key)===e&&(s.value=null)}function J(e){const t=v.value,n=t[e];delete t[e],(0,z.xb)(t)&&(v.value=null),Y(n)}function G(e){s.value={key:e,value:F(e),...f}}function X(){s.value={isAll:!0,value:L(),...f}}async function Q(e){const n=s.value;if(n.jsonPaused&&(n.jsonPaused=!1,te()),n.error){const e=n.errorPos;return D.setSelection(e,{line:e.line,ch:e.ch+1}),D.focus(),void(0,j.PV)({text:n.error})}1===e?(D.markClean(),n.dirty=!1):s.value=null,n.isAll?await(0,z.gj)("SetValueStores",{[t.script.props.id]:w(be.Xw,n.jsonValue,e=>(0,z.bd)(e)||"")}):await Y(n)}function ee(){const e=s.value;if(e.dirty){const t=`${e.key} ${1e9*Math.random()|0}`,n=D.getValue(),l=(0,z.bd)(n);(v.value||(v.value={}))[t]={key:t,rawValue:l,cut:b(n),len:V(t,l)}}s.value=null}function te(e){const t=s.value;if(t.dirty=e,t.error=null,t.jsonPaused)return;const n=h.now();try{const e=D.getValue();t.jsonValue=e.trim()?JSON.parse(e):void 0}catch(e){const n=/(position\s+)(\d+)|$/,l=D.posFromIndex(+`${e}`.match(n)[2]||0);t.error=`${e}`.replace(n,`$1${l.line+1}:${l.ch+1}`),t.errorPos=l,t.jsonValue=void 0}t.jsonPaused=h.now()-n>10}function ne(e){const t=u.values(e)[0].newValue;if(t){const e=s.value,n=null==e?void 0:e.key,l=e&&(e.isAll?L:F);if(P(t instanceof u?t:(0,be.p$)(t)),e){const t=l(n);D.getValue()===t?(e.isNew=!1,e.dirty=!1):e.dirty||(e.value=t,te())}}else P(t)}function le(e){(0,N.nk)(("ArrowDown"===e.key?1:e.target!==l.value&&-1)||0)}return(0,O.dl)(()=>{var e;const l=n.value,{id:a}=t.script.props,o=(0,z.K0)();w(p,l,"focusin",C),null==(e=s.value?D:R)||e.focus(),(0,z.gj)("GetValueStore",a,void 0,H={tab:{id:Math.random()-2},[S]:0}).then(e=>{const t=!d.value;P(e)&&t&&_.value.length&&T(!0),r.value=!1}),$=[()=>w(m,l,"focusin",C),N.$J.register("pageup",()=>A(-1),x),N.$J.register("pagedown",()=>A(1),x)],I=g.runtime.connect({name:Lt.vy+JSON.stringify({cfg:{value:a},id:null==o?void 0:o[Lt.vy](ne),tabId:H.tab.id})}),o||I.onMessage.addListener(ne),i.value=!0}),(0,O.se)(()=>{var e,t;i.value=!1,null==(e=$)||e.forEach(e=>e()),null==(t=I)||t.disconnect(),$=I=null}),(0,O.YP)(s,(e,t)=>{if(e)R=document.activeElement,(0,O.Y3)(()=>{const n=o.value;if(D=n.cm,t&&n.updateValue(e.value),e.isNew){const e=a.value;e.setSelectionRange(0,0),e.focus()}else D.setCursor(0,0),D.focus()});else if(t){var n;null==(n=R)||n.focus()}}),(0,O.YP)(c,()=>{R=null,T()}),(t,u)=>((0,O.wg)(),(0,O.iD)("div",{class:"edit-values",ref_key:"$el",ref:n,"data-editing":s.value&&""},[(0,O._)("div",Tn,[e.readOnly?(0,O.kq)("",!0):((0,O.wg)(),(0,O.iD)("button",{key:0,onClick:q},"+")),k.value>1?((0,O.wg)(),(0,O.iD)("div",On,[(0,O._)("button",{disabled:1===c.value,onClick:u[0]||(u[0]=e=>c.value-=1)},"\u2190",8,Mn),(0,O._)("span",{class:"ml-1",textContent:(0,M.zw)(c.value)},null,8,An),(0,O.Uk)(" / "),(0,O._)("span",{class:"mr-1",textContent:(0,M.zw)(k.value)},null,8,Vn),(0,O._)("button",{disabled:c.value>=k.value,onClick:u[1]||(u[1]=e=>c.value+=1)},"\u2192",8,Fn)])):(0,O.kq)("",!0),(0,O._)("span",Ln,[(0,O._)("span",null,[k.value>1?((0,O.wg)(),(0,O.iD)(O.HY,{key:0},[Pn,(0,O.Uk)(", "),Zn,(0,O.Uk)(", ")],64)):(0,O.kq)("",!0),Yn,(0,O.Uk)(", "),Nn,(0,O.Uk)(", "),Bn,(0,O.Uk)(", "),qn,(0,O.Uk)(", ")]),(0,O._)("span",null,[Kn,(0,O.Uk)(": "+(0,M.zw)(t.i18n("buttonEdit"))+",",1)]),(0,O._)("span",null,[Jn,(0,O.Uk)(": "+(0,M.zw)(t.i18n("buttonRemove")),1)])])]),(0,O._)("div",{class:"edit-values-table main",onKeydown:[(0,B.D2)((0,B.iM)(le,["exact"]),["down"]),(0,B.D2)((0,B.iM)(le,["exact"]),["up"])]},[(0,O._)("a",{ref_key:"$editAll",ref:l,class:"edit-values-row flex",onClick:X,tabindex:"0",textContent:(0,M.zw)(t.i18n("editValueAllHint"))},null,8,Xn),((0,O.wg)(!0),(0,O.iD)(O.HY,null,(0,O.Ko)(U.value,e=>((0,O.wg)(),(0,O.iD)("div",{key:e,class:"edit-values-row flex monospace-font",onKeydown:(0,B.D2)((0,B.iM)(t=>K(e),["ctrl","exact"]),["delete"]),onClick:t=>G(e)},[(0,O._)("div",el,[(0,O._)("a",{textContent:(0,M.zw)(e),tabindex:"0"},null,8,tl)]),(0,O._)("div",{class:"ellipsis flex-auto",textContent:(0,M.zw)(F(e,!0))},null,8,nl),(0,O._)("pre",{textContent:(0,M.zw)(V(e))},null,8,ll),(0,O._)("div",{class:"del",onClick:(0,B.iM)(t=>K(e),["stop"])},[(0,O.Wm)((0,E.SU)(_e.Z),{name:"trash"})],8,al)],40,Qn))),128))],40,Gn),v.value?((0,O.wg)(),(0,O.iD)("h3",{key:0,textContent:(0,M.zw)(t.i18n("headerRecycleBin"))},null,8,ol)):(0,O.kq)("",!0),v.value?((0,O.wg)(),(0,O.iD)("div",{key:1,class:"edit-values-table trash monospace-font",onKeydown:[(0,B.D2)((0,B.iM)(le,["exact"]),["down"]),(0,B.D2)((0,B.iM)(le,["exact"]),["up"])]},[((0,O.wg)(!0),(0,O.iD)(O.HY,null,(0,O.Ko)(v.value,({key:e,cut:t,len:n},l)=>((0,O.wg)(),(0,O.iD)("div",{key:l,class:"edit-values-row flex",onClick:e=>J(l)},[(0,O._)("a",{class:"ellipsis",textContent:(0,M.zw)(e),tabindex:"0"},null,8,rl),(0,O._)("s",{class:"ellipsis flex-auto",textContent:(0,M.zw)(t)},null,8,cl),(0,O._)("pre",{textContent:(0,M.zw)(n)},null,8,ul)],8,sl))),128))],40,il)):(0,O.kq)("",!0),r.value||_.value.length?(0,O.kq)("",!0):((0,O.wg)(),(0,O.iD)("div",{key:2,class:"edit-values-empty mt-1",textContent:(0,M.zw)(t.i18n("noValues"))},null,8,dl)),s.value?((0,O.wg)(),(0,O.iD)("div",pl,[(0,O._)("div",ml,[(0,O._)("h4",{textContent:(0,M.zw)(s.value.isAll?t.i18n("labelEditValueAll"):t.i18n("labelEditValue"))},null,8,gl),(0,O._)("div",null,[((0,O.wg)(!0),(0,O.iD)(O.HY,null,(0,O.Ko)([t.i18n("buttonOK"),t.i18n("buttonApply")],(e,t)=>((0,O.wg)(),(0,O.iD)("button",{key:e,textContent:(0,M.zw)(e),onClick:e=>Q(t),class:(0,M.C_)({"has-error":s.value.error,"save-beacon":!t}),title:s.value.error,disabled:s.value.error||!s.value.dirty},null,10,hl))),128)),(0,O._)("button",{textContent:(0,M.zw)(t.i18n("buttonCancel")),onClick:ee,title:"Esc"},null,8,vl)])]),(0,O.wy)((0,O._)("label",null,[(0,O._)("span",{textContent:(0,M.zw)(t.i18n("valueLabelKey"))},null,8,fl),(0,O.wy)((0,O._)("input",{type:"text","onUpdate:modelValue":u[2]||(u[2]=e=>s.value.key=e),readOnly:!s.value.isNew||e.readOnly,ref_key:"$key",ref:a,spellcheck:"false",onKeydown:(0,B.D2)((0,B.iM)(ee,["exact","stop"]),["esc"])},null,40,wl),[[B.nr,s.value.key]])],512),[[B.F8,!s.value.isAll]]),(0,O._)("label",null,[(0,O._)("span",{textContent:(0,M.zw)(s.value.isAll?t.i18n("valueLabelValueAll"):t.i18n("valueLabelValue"))},null,8,bl),(0,O.Wm)((0,E.SU)(Vt.default),{value:s.value.value,ref_key:"$value",ref:o,class:"h-100 mt-1",mode:"application/json",readOnly:e.readOnly,onCodeDirty:te,commands:{close:ee,save:Q},active:i.value,focusme:""},null,8,["value","readOnly","commands","active"])])])):(0,O.kq)("",!0)],8,Wn))}},xl=yl,Cl={class:"edit-help mb-2c"},_l=["innerHTML"],kl=(0,O._)("a",{href:"https://violentmonkey.github.io/api/",rel:"noopener noreferrer",target:"_blank"},"violentmonkey.github.io/api/",-1),Sl={class:"keyboard"},Ul=["textContent"],zl=["textContent"],Dl=["textContent"],$l={__name:"help",props:{hotkeys:Array},setup:e=>(t,n)=>((0,O.wg)(),(0,O.iD)("div",Cl,[(0,O._)("div",null,[(0,O._)("h3",{innerHTML:t.i18n("editHelpDocumention")},null,8,_l),kl]),(0,O._)("div",Sl,[(0,O._)("h3",{textContent:(0,M.zw)(t.i18n("editHelpKeyboard"))},null,8,Ul),((0,O.wg)(!0),(0,O.iD)(O.HY,null,(0,O.Ko)(e.hotkeys,([e,t])=>((0,O.wg)(),(0,O.iD)("dl",{key:e},[(0,O._)("dt",{class:"monospace-font",textContent:(0,M.zw)(e)},null,8,zl),(0,O._)("dd",{textContent:(0,M.zw)(t)},null,8,Dl)]))),128))])]))},Rl={class:"edit-header flex mr-1c"},jl=["textContent","onClick"],Hl={class:"edit-name text-center ellipsis flex-1"},El=["textContent"],Il=["textContent"],Wl={key:1,class:"edit-hint text-right ellipsis"},Tl=["href","textContent"],Ol={class:"mr-1"},Ml=["textContent","disabled","title"],Al=["textContent","disabled"],Vl=["textContent"],Fl={key:0,class:"frozen-note shelf mr-2c flex flex-wrap"},Ll=["textContent"],Pl={key:1,class:"shelf fatal"},Zl=["textContent"],Yl={key:2,class:"errors shelf my-1c"},Nl=["textContent"],Bl={class:"my-1"},ql=["href","textContent"],Kl={__name:"index",props:{initial:u,initialCode:String,readOnly:r},emits:["close"],setup(t,{emit:n}){const o=t;let i,s,c,d,m,h,v;const f=(0,E.iH)(),x=(0,E.iH)(),C=(0,E.iH)("code"),_=(0,E.iH)(!1),k=(0,E.iH)(),S=(0,E.iH)(""),U=(0,E.iH)(!1),D={save:ee,close:te},$=(0,E.iH)(),H=(0,E.iH)(),T=(0,E.iH)(),A=(0,E.iH)(!1),V=(0,E.iH)(!1),F=(0,E.iH)("https://violentmonkey.github.io/api/matching/"),L=(0,O.Fl)(()=>{const{meta:e,props:{id:t}}=k.value,n=e.require.length&&"@require",l=!(0,z.xb)(e.resources)&&"@resource",a=W.storageSize;return{code:(0,z.ag)("editNavCode"),settings:(0,z.ag)("editNavSettings"),...t&&{values:(0,z.ag)("editNavValues")+(a?` (${(0,z.aj)(a)})`:"")},...(n||l)&&{externals:w(z.Hv,[n,l],"/")},help:"?"}}),P=(0,O.Fl)(()=>W.title=(0,z.pV)(k.value));(0,O.YP)(C,async e=>{await(0,O.Y3)(),"code"===e?i.focus():(0,j.wO)(x.value.$el)},{immediate:!0}),(0,O.YP)(_,e=>{v(e),N.$J.setContext("canSave",e)}),(0,O.YP)(()=>o.initial.error,e=>{e&&(0,j.PV)({text:`${o.initial.message}\n\n${e}`})}),(0,O.YP)(U,se),(0,O.YP)(k,e=>{const{custom:t,config:n}=e,{shouldUpdate:l}=n;n._editable=2===l,n.enabled=!!n.enabled,n.shouldUpdate=!!l,n.notifyUpdates=(0,z.jd)(n.notifyUpdates),t.noframes=(0,z.jd)(t.noframes);for(const e in Z)null==t[e]&&(t[e]=Z[e]);for(let e=0;e<J.length;e++){const n=J[e];t[n]||(t[n]="")}for(let e=0;e<q.length;e++){const n=q[e],l=t[n];t[n]=l?`${l.join("\n")}${l.length?"\n":""}`:""}ie(),n.removed||(m=(0,be.p$)(e))});const Z={name:"",homepageURL:"",updateURL:"",downloadURL:"",origInclude:!0,origExclude:!0,origMatch:!0,origExcludeMatch:!0},Y=e=>""!==e?e:null,q=["include","match","exclude","excludeMatch"],K=e=>e.trim()?e.split("\n").map(e=>e.trim()).filter(r):null,J=[l,a],G=e=>e||null,X=(e,t)=>e<t?-1:e>t,Q=({shouldUpdate:e,_editable:t})=>+e&&e+t;{const e=o.initial;S.value=o.initialCode,k.value=(0,be.p$)(e),(0,O.YP)(()=>k.value.config,ie,{deep:!0}),(0,O.YP)(()=>k.value.custom,ie,{deep:!0})}async function ee(){if(!_.value)return;h&&re();const e=k.value,{config:t,custom:n}=e,{notifyUpdates:l}=t,{noframes:a}=n;try{var o;const r=e.props.id,c=await(0,z.gj)("ParseScript",{id:r,code:s.getRealContent(),config:{enabled:+t.enabled,notifyUpdates:l?+l:null,shouldUpdate:Q(t)},custom:{...(0,be.zr)(n,u.keys(Z),Y),...(0,be.zr)(n,q,K),...(0,be.zr)(n,J,G),noframes:a?+a:null},isNew:!r,message:""}),d=null==c||null==(o=c.where)?void 0:o.id;i.markClean(),U.value=!1,_.value=!1,V.value=!1,H.value=c.errors,k.value=c.update,d&&!r&&history.replaceState(null,P.value,`${y}/${d}`),T.value=null}catch(e){T.value=e.message.split("\n")}}function te(e){var t;e||"code"===C.value?(n("close"),b&&(null==(t=document.activeElement)||t.blur())):C.value="code"}async function ne(){await ee(),te(!0)}function le(e){const t=u.keys(L.value);C.value=t[(t.indexOf(C.value)+e+t.length)%t.length]}function ae(){le(-1)}function oe(){le(1)}function ie(e){const t=k.value,{config:n}=t,{removed:l}=n,a=(t._remote=!!(0,z.TZ)(t))&&Q(n),i=!(!l&&1!==a&&!o.readOnly);A.value=i,V.value=!l&&(i||a>=1),!l&&e&&se()}function se(){_.value=U.value||!(0,be.vZ)(k.value,m)}async function re(e){R.Z.get("editorWindow")&&(e||(e=await(null==z.oy?void 0:z.oy.getCurrent())||{}),"normal"===e.state&&R.Z.set("editorWindowPos",(0,be.zr)(e,["left","top","width","height"])))}function ce({id:e,tabs:t}){if(1===t.length){const{onBoundsChanged:t}=g.windows;t?t.addListener(t=>{t.id===e&&re(t)}):(p("resize",(0,z.Ds)(re,100)),h=!0)}}return(0,O.bv)(()=>{var t,n;s=f.value,i=s.cm,v=(0,I.Q$)(null,()=>i.focus()),R.Z.get("editorWindow")&&1===e.history.length&&(null==(n=browser.windows)||n.getCurrent({populate:!0}).then(ce)),W.storageSize=0;const l=u.values(L.value),a=$.value=[["Alt-PageUp",` ${l.join(" < ")}`],["Alt-PageDown",` ${l.join(" > ")}`],...u.entries(s.expandKeyMap()).sort((e,t)=>X(e[1],t[1])||X(e[0],t[0]))];d=null==(t=a.find(([,e])=>"save"===e))?void 0:t[0],d||(d="Ctrl-S",a.unshift([d,"save"]))}),(0,O.dl)(()=>{document.body.classList.add("edit-open"),c=[N.$J.register("a-pageup",ae),N.$J.register("a-pagedown",oe),N.$J.register(d.replace(/(?:Ctrl|Cmd)-/i,"ctrlcmd-"),ee),N.$J.register("escape",te),N.$J.register("f1",()=>{C.value="help"})],W.title=P.value}),(0,O.se)(()=>{var e;document.body.classList.remove("edit-open"),W.title=null,v(!1),null==(e=c)||e.forEach(e=>e())}),(e,n)=>((0,O.wg)(),(0,O.iD)("div",{class:(0,M.C_)(["edit frame flex flex-col abs-full",{frozen:A.value}])},[(0,O._)("div",Rl,[(0,O._)("nav",null,[((0,O.wg)(!0),(0,O.iD)(O.HY,null,(0,O.Ko)(L.value,(e,t)=>((0,O.wg)(),(0,O.iD)("div",{key:t,class:(0,M.C_)(["edit-nav-item",{active:C.value===t}]),textContent:(0,M.zw)(e),onClick:e=>C.value=t},null,10,jl))),128))]),(0,O._)("div",Hl,[k.value.config.removed?((0,O.wg)(),(0,O.iD)("span",{key:0,class:"subtle",textContent:(0,M.zw)((0,E.SU)(z.ag)("headerRecycleBin")+" / ")},null,8,El)):(0,O.kq)("",!0),(0,O.Uk)(" "+(0,M.zw)(P.value),1)]),A.value&&"code"===C.value?((0,O.wg)(),(0,O.iD)("p",{key:0,textContent:(0,M.zw)((0,E.SU)(z.ag)("readonly")),class:"text-upper text-right text-red"},null,8,Il)):((0,O.wg)(),(0,O.iD)("div",Wl,[(0,O._)("a",{href:(0,E.SU)(j.XB),target:"_blank",rel:"noopener noreferrer",textContent:(0,M.zw)((0,E.SU)(z.ag)("editHowToHint"))},null,8,Tl)])),(0,O._)("div",Ol,[(0,O.wy)((0,O._)("button",{textContent:(0,M.zw)((0,E.SU)(z.ag)("buttonSave")),onClick:ee,disabled:!_.value,class:(0,M.C_)({"has-error":e.$fe=T.value||H.value}),title:e.$fe},null,10,Ml),[[B.F8,_.value||!A.value]]),(0,O.wy)((0,O._)("button",{textContent:(0,M.zw)((0,E.SU)(z.ag)("buttonSaveClose")),onClick:ne,disabled:!_.value},null,8,Al),[[B.F8,_.value||!A.value]]),(0,O._)("button",{textContent:(0,M.zw)((0,E.SU)(z.ag)("buttonClose")),onClick:n[0]||(n[0]=e=>te(!0)),title:"Esc"},null,8,Vl)])]),V.value&&"code"===C.value?((0,O.wg)(),(0,O.iD)("div",Fl,[(0,O._)("p",{textContent:(0,M.zw)((0,E.SU)(z.ag)("readonlyNote"))},null,8,Ll),((0,O.wg)(),(0,O.j4)(O.Ob,null,[(0,O.Wm)((0,E.SU)(Jt),{class:"flex ml-2c",script:k.value},null,8,["script"])],1024))])):(0,O.kq)("",!0),T.value?((0,O.wg)(),(0,O.iD)("p",Pl,[(0,O._)("b",{textContent:(0,M.zw)(T.value[0])},null,8,Zl),(0,O.Uk)(" "+(0,M.zw)(T.value[1]),1)])):(0,O.kq)("",!0),(0,O.wy)((0,O.Wm)((0,E.SU)(Vt.default),{class:(0,M.C_)(["flex-auto",{readonly:A.value}]),value:S.value,readOnly:A.value,ref_key:"$code",ref:f,active:"code"===C.value,commands:D,onCodeDirty:n[1]||(n[1]=e=>U.value=e)},null,8,["class","value","readOnly","active"]),[[B.F8,"code"===C.value]]),((0,O.wg)(),(0,O.j4)(O.Ob,{ref_key:"$tabBody",ref:x},["settings"===C.value?((0,O.wg)(),(0,O.j4)((0,E.SU)(In),(0,O.dG)({key:0,class:"edit-body"},{readOnly:t.readOnly,script:k.value}),null,16)):"values"===C.value?((0,O.wg)(),(0,O.j4)((0,E.SU)(xl),(0,O.dG)({key:1,class:"edit-body"},{readOnly:t.readOnly,script:k.value}),null,16)):"externals"===C.value?((0,O.wg)(),(0,O.j4)((0,E.SU)(Ft.Z),{key:2,class:"flex-auto",value:k.value},null,8,["value"])):"help"===C.value?((0,O.wg)(),(0,O.j4)((0,E.SU)($l),{key:3,class:"edit-body",hotkeys:$.value},null,8,["hotkeys"])):(0,O.kq)("",!0)],1536)),H.value?((0,O.wg)(),(0,O.iD)("div",Yl,[((0,O.wg)(!0),(0,O.iD)(O.HY,null,(0,O.Ko)(H.value,e=>((0,O.wg)(),(0,O.iD)("p",{key:e,textContent:(0,M.zw)(e),class:"text-red"},null,8,Nl))),128)),(0,O._)("p",Bl,[(0,O._)("a",{href:F.value,target:"_blank",rel:"noopener noreferrer",textContent:(0,M.zw)(F.value)},null,8,ql)])])):(0,O.kq)("",!0)],2))}},Jl=Kl,Gl={sort:{exec:{title:(0,z.ag)("filterExecutionOrder")},alpha:{title:(0,z.ag)("filterAlphabeticalOrder"),compare:({$cache:{lowerName:e}},{$cache:{lowerName:t}})=>e<t?-1:e>t},update:{title:(0,z.ag)("filterLastUpdateOrder"),compare:({props:{lastUpdated:e}},{props:{lastUpdated:t}})=>(+t||0)-(+e||0)},size:{title:(0,z.ag)("filterSize"),compare:(e,t)=>t.$cache.sizeNum-e.$cache.sizeNum}}},Xl=(0,E.qj)({searchScope:null,showEnabledFirst:null,showOrder:null,viewSingleColumn:null,viewTable:null,sort:null}),Ql=e=>Xl.showEnabledFirst?(t,n)=>n.config.enabled-t.config.enabled||e(t,n):e;w(be.SE,Xl,e=>{(0,we.Z)(`filters.${e}`,t=>{Xl[e]=t,"sort"!==e||Gl.sort[t]||(Xl[e]=u.keys(Gl.sort)[0])})});const ea="tabScripts",ta=`${ea} && inputFocus`,na=`${ea} && !inputFocus`,la=`${na} && selectedScript && !showRecycle`,aa=`${na} && selectedScript && showRecycle`,oa=`${na} && !buttonFocus`,ia=`${na} && selectedScript && showHotkeys`,sa={edit:"e",toggle:"space",update:"r",restore:"r",remove:"x"},ra=(e,t)=>t.map(([t,n,l])=>N.$J.register(t,e,{condition:n,caseSensitive:l})),ca=100;let ua,da=0,pa=[],ma=[];const ga=(0,E.iH)(),ha=(0,E.iH)(),va=(0,E.iH)(),fa=(0,E.qj)({focusedIndex:-1,menuNewActive:!1,showHotkeys:!1,search:"",searchError:null,sortedScripts:[],filteredScripts:[],script:null,code:"",numColumns:1,batchRender:{limit:da}}),wa=(0,O.Fl)(()=>W.route.paths[0]===k),ba=(0,O.Fl)(()=>!wa.value&&"exec"===Xl.sort),ya=(0,O.Fl)(()=>j.T&&ba.value),xa=(0,O.Fl)(()=>{var e;return null==(e=Gl.sort[Xl.sort])?void 0:e.compare}),Ca=(0,O.Fl)(()=>fa.filteredScripts[fa.focusedIndex]),_a=(0,O.Fl)(()=>W.loading||(fa.search?fa.sortedScripts.find(e=>!1!==e.$cache.show):fa.sortedScripts.length)?null:(0,z.ag)("labelNoSearchScripts")),ka=(0,O.Fl)(()=>fa.search&&["code","all"].includes(Xl.searchScope)&&W.scripts.filter(e=>null==e.$cache.code).map(e=>e.props.id)),Sa=()=>wa.value?W.removedScripts:W.scripts,Ua=(0,z.Ds)(Ra,100),za=(0,z.Ds)(Aa);function Da(){!wa.value&&W.needRefresh&&(W.scripts=W.scripts.filter(e=>!e.config.removed),W.needRefresh=!1),fa.focusedIndex=-1,Ra()}async function $a(){const e=ka.value;null!=e&&e.length&&await La(e),Ra(),Ma()}function Ra(){const e=[...Sa()],t=fa.search?Va(e):e.length,n=xa.value;n&&e.sort(Ql(n)),fa.sortedScripts=e,fa.filteredScripts=fa.search?e.filter(({$cache:e})=>e.show):e,Na(fa.focusedIndex),!da||t<da?Aa():za()}function ja(){(0,z.gj)("CheckUpdate")}async function Ha(){try{var e;let t=await(0,j.GW)((0,z.ag)("hintInputURL"),{input:"",ok:{type:"submit"}});t=null==(e=t)?void 0:e.trim(),t&&(t.includes("://")||(t=`https://${t}`),new URL(t),await(0,z.gj)("ConfirmInstall",{url:t}))}catch(e){e&&(0,j.PV)({text:e})}}async function Ea(e,t){if(e===t)return;const n=fa.filteredScripts,l=W.scripts,a=n[e],o=l.indexOf(a),i=l.indexOf(n[t]),{id:s}=a.props;await(0,z.gj)("Move",{id:s,offset:i-o})&&(l.splice(o,1),l.splice(i,0,a),l.forEach((e,t)=>{e.props.position=t+1}),Ra())}function Ia(e){R.Z.set("filters.sort",e.target.value)}function Wa(e){fa.search&&Fa(),R.Z.set("filters.searchScope",e.target.value)}function Ta(e){fa.menuNewActive=e}function Oa(e){const n=w(z.Hv,[wa.value?k:o,e],"/");e||n!==(0,I.Qs)().pathname?(0,I.pV)(n):t.history.back()}async function Ma(){const[e,t,n]=W.route.paths,l="_new"===t&&await(0,z.gj)("NewScript",+n),a=l?l.script:+t&&Sa().find(e=>e.props.id===+t);if(a)return fa.code=l?l.code:await(0,z.gj)("GetScriptCode",t),void(fa.script=a);if(t&&(0,I.pV)(e,!0),W.canRenderScripts||(W.canRenderScripts=!0,dr()),Aa(),fa.script=null,!b){const e=va.value,t=e.scrollTop;(0,O.Y3)(()=>{e.scrollTop=t})}}async function Aa(){if(!W.canRenderScripts)return;const{length:e}=fa.sortedScripts;let t=9;const n=(0,E.qj)({limit:t});fa.batchRender=n;const l=h.now();for(;t<e&&n===fa.batchRender;){if(da&&fa.search)for(let n=0;n<da&&t<e;t+=1)n+=fa.sortedScripts[t].$cache.show?1:0;else t+=da||1;n.limit=t,await new d(e=>(0,O.Y3)(e)),!da&&h.now()-l>=ca&&(da=2*t),da&&t<e&&await(0,z.dL)()}}function Va(e){let t,n=0;const[,l=fa.search.replace(/[.+^*$?|\\()[\]{}]/g,"\\$&"),a="i"]=fa.search.match(/^\/(.+?)\/(\w*)$|$/),o=Xl.searchScope,i="name"===o||"all"===o,s="code"===o||"all"===o;try{t=l&&new RegExp(l,a),e.forEach(({$cache:e})=>{e.show=!l||i&&t.test(e.search)||s&&t.test(e.code),n+=e.show}),fa.searchError=null}catch(e){fa.searchError=e.message}return n}async function Fa(){const e=ka.value;null!=e&&e.length&&await La(e),Ua()}async function La(e){const t=await(0,z.gj)("GetScriptCode",e);W.scripts.forEach(({$cache:e,props:{id:n}})=>{n in t&&(e.code=t[n])})}async function Pa(){await(0,j.GW)((0,z.ag)("buttonEmptyRecycleBin"))&&((0,z.gj)("CheckRemove",{force:!0}),W.removedScripts=[])}function Za(e){if(Ya(),e&&!ua){ua=(0,H.w)("-width: 76");for(let e=0,t=ua;e<t.length;e++){const n=t[e];n._orig=n.conditionText}}if(ua)for(let t=0,n=ua;t<n.length;t++){const l=n[t],a=l._orig;l.media.mediaText=e?a.replace(/\d+/g,e=>+e+90/devicePixelRatio):a}}function Ya(){const e=Xl.viewTable?pa:ma;fa.numColumns=Xl.viewSingleColumn?1:e.findIndex(e=>t.innerWidth<e)+1||e.length+1}function Na(e){e=Math.min(e,fa.filteredScripts.length-1),(e=Math.max(e,-1))!==fa.focusedIndex&&(fa.focusedIndex=e)}function Ba(e){e.config.removed?(0,z.gj)("RemoveScripts",[e.props.id]):T(e,1)}async function qa(e){try{await T(e,0)}catch(t){(0,j.GW)(`${t.message||t}\n\n@namespace ${e.meta.namespace}\n@name ${e.meta.name}`,{cancel:!1})}}function Ka(e){(0,z.gj)("UpdateScriptInfo",{id:e.props.id,config:{enabled:e.config.enabled?0:1}})}function Ja(e){(0,z.gj)("CheckUpdate",e.props.id)}function Ga(e){if(!e)return;const t=ha.value;t.scroll({top:t.scrollTop+e,behavior:"smooth"})}function Xa(){const e=()=>{var e;N.$J.setContext("buttonFocus",(null==(e=document.activeElement)?void 0:e.tabIndex)>=0)};p("focus",e,!0);const t=[()=>m("focus",e,!0),...b?[N.$J.register("tab",()=>{(0,N.nk)(1)}),N.$J.register("s-tab",()=>{(0,N.nk)(-1)})]:[],...ra(()=>{var e;null==(e=ga.value)||e.focus()},[["ctrlcmd-f",ea],["/",na,!0]]),...ra(()=>{var e;null==(e=ga.value)||e.blur()},[["enter",ta]]),...ra(()=>{fa.showHotkeys=!1},[["escape",ia],["q",ia,!0]]),...ra(()=>{let e=fa.focusedIndex;e<0?e=0:e+=fa.numColumns,e<fa.filteredScripts.length&&Na(e)},[["ctrlcmd-down",ea],["down",ea],["j",na,!0]]),...ra(()=>{const e=fa.focusedIndex-fa.numColumns;e>=0&&Na(e)},[["ctrlcmd-up",ea],["up",ea],["k",na,!0]]),...ra(()=>{Na(fa.focusedIndex-1)},[["ctrlcmd-left",ea],["left",na],["h",na,!0]]),...ra(()=>{Na(fa.focusedIndex+1)},[["ctrlcmd-right",ea],["right",na],["l",na,!0]]),...ra(()=>{Na(0)},[["ctrlcmd-home",ea],["g g",na,!0]]),...ra(()=>{Na(fa.filteredScripts.length-1)},[["ctrlcmd-end",ea],["G",na,!0]]),...ra(()=>{Oa(Ca.value.props.id)},[[sa.edit,la,!0],["enter",oa]]),...ra(()=>{Ba(Ca.value)},[["delete",la],[sa.remove,la,!0]]),...ra(()=>{Ja(Ca.value)},[[sa.update,la,!0]]),...ra(()=>{Ka(Ca.value)},[[sa.toggle,la,!0]]),...ra(()=>{qa(Ca.value)},[[sa.restore,aa,!0]]),...ra(()=>{fa.showHotkeys=!fa.showHotkeys},[["?",na,!0]])];return()=>t.forEach(e=>{e()})}const Qa={components:{Dropdown:ye.Z,Tooltip:xe.Z,SettingCheck:Ce.Z,Icon:_e.Z,LocaleGroup:ke.Z,ScriptItem:At,Edit:Jl},directives:{focus:j.Tu},setup:()=>(Da(),(0,O.YP)(wa,Da),(0,O.YP)(()=>W.canRenderScripts&&ha.value&&ba.value,e=>Ge(ha.value,Ea,e)),(0,O.YP)(()=>fa.search,Fa),(0,O.YP)(()=>[Xl.sort,Xl.showEnabledFirst],Ua),screen.availWidth>767&&((0,O.YP)(()=>Xl.viewSingleColumn,Ya),(0,O.YP)(()=>Xl.viewTable,Za)),(0,O.YP)(Sa,$a),(0,O.YP)(()=>W.route.paths[1],Ma),(0,O.YP)(Ca,e=>{N.$J.setContext("selectedScript",e)}),(0,O.YP)(()=>fa.showHotkeys,e=>{N.$J.setContext("showHotkeys",e)}),(0,O.bv)(()=>{if(W.loading||$a(),!ma.length){const e=(null==H.$?void 0:H.$.textContent.match(/--columns-(cards|table)\b/))&&getComputedStyle(document.documentElement);if(e)for(let t=0,n=[["cards",ma],["table",pa]];t<n.length;t++){const[l,a]=n[t],o=e.getPropertyValue(`--columns-${l}`);o&&a.push(...o.split(",").map(Number).filter(r))}else ma.push(1300,1900,2500),pa.push(1600,2500,3400);p("resize",Ya)}return Ya(),Xa()}),{refSearch:ga,refList:ha,scroller:va,store:W,state:fa,filters:Xl,filterOptions:Gl,currentSortCompare:xa,selectedScript:Ca,draggable:ya,scriptHotkeys:sa,showRecycle:wa,message:_a,handleStateChange:Ta,handleOrderChange:Ia,handleEditScript:Oa,handleEmptyRecycleBin:Pa,handleInstallFromURL:Ha,handleUpdateAll:ja,handleOnScopeChange:Wa,handleActionRemove:Ba,handleActionRestore:qa,handleActionToggle:Ka,handleActionUpdate:Ja,handleSmoothScroll:Ga})},eo=(0,Ot.Z)(Qa,[["render",(e,t,n,l,a,o)=>{const i=(0,O.up)("Icon"),s=(0,O.up)("Tooltip"),r=(0,O.up)("Dropdown"),c=(0,O.up)("LocaleGroup"),u=(0,O.up)("SettingCheck"),d=(0,O.up)("script-item"),p=(0,O.up)("edit"),m=(0,O.Q2)("focus");return(0,O.wg)(),(0,O.iD)("div",q,[l.store.canRenderScripts?((0,O.wg)(),(0,O.iD)("div",K,[(0,O._)("header",J,[l.showRecycle?((0,O.wg)(),(0,O.iD)("div",{key:1,class:"flex-auto",textContent:(0,M.zw)(e.i18n("headerRecycleBin"))},null,8,le)):((0,O.wg)(),(0,O.iD)("div",G,[(0,O.Wm)(r,{closeAfterClick:!0,class:(0,M.C_)({active:l.state.menuNewActive}),onStateChange:l.handleStateChange},{content:(0,O.w5)(()=>[(0,O._)("a",{class:"dropdown-menu-item",textContent:(0,M.zw)(e.i18n("buttonNew")),tabindex:"0",onClick:t[0]||(t[0]=(0,B.iM)(e=>l.handleEditScript("_new"),["prevent"]))},null,8,Q),(0,O._)("a",{class:"dropdown-menu-item",textContent:(0,M.zw)(e.i18n("installFrom","OpenUserJS")),href:"https://openuserjs.org/",target:"_blank",rel:"noopener noreferrer"},null,8,ee),(0,O._)("a",{class:"dropdown-menu-item",textContent:(0,M.zw)(e.i18n("installFrom","GreasyFork")),href:"https://greasyfork.org/scripts",target:"_blank",rel:"noopener noreferrer"},null,8,te),(0,O._)("a",{class:"dropdown-menu-item",textContent:(0,M.zw)(e.i18n("buttonInstallFromURL")),tabindex:"0",onClick:t[1]||(t[1]=(0,B.iM)((...e)=>l.handleInstallFromURL&&l.handleInstallFromURL(...e),["prevent"]))},null,8,ne)]),default:(0,O.w5)(()=>[(0,O.Wm)(s,{content:e.i18n("buttonNew"),placement:"bottom",align:"start"},{default:(0,O.w5)(()=>[(0,O._)("a",X,[(0,O.Wm)(i,{name:"plus"})])]),_:1},8,["content"])]),_:1},8,["class","onStateChange"]),(0,O.Wm)(s,{content:e.i18n("buttonUpdateAll"),placement:"bottom",align:"start"},{default:(0,O.w5)(()=>[(0,O._)("a",{class:"btn-ghost",tabindex:"0",onClick:t[2]||(t[2]=(...e)=>l.handleUpdateAll&&l.handleUpdateAll(...e))},[(0,O.Wm)(i,{name:"refresh"})])]),_:1},8,["content"])])),(0,O.Wm)(c,{"i18n-key":"labelFilterSort"},{default:(0,O.w5)(()=>[(0,O._)("select",{value:l.filters.sort,onChange:t[3]||(t[3]=(...e)=>l.handleOrderChange&&l.handleOrderChange(...e)),class:"h-100"},[((0,O.wg)(!0),(0,O.iD)(O.HY,null,(0,O.Ko)(l.filterOptions.sort,(e,t)=>((0,O.wg)(),(0,O.iD)("option",{textContent:(0,M.zw)(e.title),key:t,value:t},null,8,oe))),128))],40,ae)]),_:1}),(0,O.Wm)(r,{align:"right",class:"filter-sort"},{content:(0,O.w5)(()=>[(0,O.wy)((0,O._)("div",null,[(0,O.Wm)(u,{name:"filters.showEnabledFirst",label:e.i18n("optionShowEnabledFirst")},null,8,["label"])],512),[[B.F8,l.currentSortCompare]]),(0,O._)("div",null,[(0,O.Wm)(u,{name:"filters.showOrder",label:e.i18n("labelShowOrder")},null,8,["label"])]),(0,O._)("div",se,[(0,O.Wm)(u,{name:"filters.viewTable",label:e.i18n("labelViewTable")},null,8,["label"]),(0,O.Wm)(u,{name:"filters.viewSingleColumn",label:e.i18n("labelViewSingleColumn")},null,8,["label"])])]),default:(0,O.w5)(()=>[(0,O.Wm)(s,{content:e.i18n("labelSettings"),placement:"bottom"},{default:(0,O.w5)(()=>[(0,O._)("a",ie,[(0,O.Wm)(i,{name:"cog"})])]),_:1},8,["content"])]),_:1}),(0,O._)("form",{class:"filter-search hidden-xs flex",onSubmit:t[7]||(t[7]=(0,B.iM)(()=>{},["prevent"]))},[(0,O.Wm)(s,{placement:"bottom"},{content:(0,O.w5)(()=>[(0,O._)("pre",{class:"filter-search-tooltip",textContent:(0,M.zw)(l.state.searchError||e.i18n("titleSearchHint"))},null,8,ce)]),default:(0,O.w5)(()=>[(0,O._)("label",null,[(0,O.wy)((0,O._)("input",{type:"search",class:(0,M.C_)({"has-error":l.state.searchError}),placeholder:e.i18n("labelSearchScript"),"onUpdate:modelValue":t[4]||(t[4]=e=>l.state.search=e),ref:"refSearch",id:"installed-search"},null,10,re),[[B.nr,l.state.search]]),(0,O.Wm)(i,{name:"search"})])]),_:1}),(0,O.wy)((0,O._)("select",{"onUpdate:modelValue":t[5]||(t[5]=e=>l.filters.searchScope=e),onChange:t[6]||(t[6]=(...e)=>l.handleOnScopeChange&&l.handleOnScopeChange(...e))},[(0,O._)("option",{value:"name",textContent:(0,M.zw)(e.i18n("filterScopeName"))},null,8,ue),(0,O._)("option",{value:"code",textContent:(0,M.zw)(e.i18n("filterScopeCode"))},null,8,de),(0,O._)("option",{value:"all",textContent:(0,M.zw)(e.i18n("filterScopeAll"))},null,8,pe)],544),[[B.bM,l.filters.searchScope]])],32)]),l.showRecycle?((0,O.wg)(),(0,O.iD)("div",me,[(0,O._)("span",{textContent:(0,M.zw)(e.i18n("hintRecycleBin"))},null,8,ge),l.store.removedScripts.length?((0,O.wg)(),(0,O.iD)("a",{key:0,textContent:(0,M.zw)(e.i18n("buttonEmptyRecycleBin")),tabindex:"0",onClick:t[8]||(t[8]=(...e)=>l.handleEmptyRecycleBin&&l.handleEmptyRecycleBin(...e))},null,8,he)):(0,O.kq)("",!0)])):l.message?((0,O.wg)(),(0,O.iD)("div",{key:1,class:"hint mx-1 my-1 flex flex-col",textContent:(0,M.zw)(l.message)},null,8,ve)):(0,O.kq)("",!0),(0,O.wy)(((0,O.wg)(),(0,O.iD)("div",{class:"scripts",ref:"refList",style:(0,M.j5)(`--num-columns:${l.state.numColumns}`),"data-columns":l.state.numColumns,"data-show-order":l.filters.showOrder||null,"data-table":l.filters.viewTable||null},[((0,O.wg)(!0),(0,O.iD)(O.HY,null,(0,O.Ko)(l.state.sortedScripts,(e,t)=>(0,O.wy)(((0,O.wg)(),(0,O.j4)(d,{key:e.props.id,focused:l.selectedScript===e,showHotkeys:l.state.showHotkeys,script:e,draggable:l.draggable,visible:t<l.state.batchRender.limit,viewTable:l.filters.viewTable,hotkeys:l.scriptHotkeys,onRemove:l.handleActionRemove,onRestore:l.handleActionRestore,onToggle:l.handleActionToggle,onUpdate:l.handleActionUpdate,onScrollDelta:l.handleSmoothScroll},null,8,["focused","showHotkeys","script","draggable","visible","viewTable","hotkeys","onRemove","onRestore","onToggle","onUpdate","onScrollDelta"])),[[B.F8,!l.state.search||!1!==e.$cache.show]])),128))],12,fe)),[[m,!l.state.script]])])):(0,O.kq)("",!0),((0,O.wg)(),(0,O.j4)(O.lR,{to:"body"},[((0,O.wg)(),(0,O.j4)(O.Ob,{key:l.store.route.hash,max:5},[l.state.script?((0,O.wg)(),(0,O.j4)(p,{key:0,initial:l.state.script,"initial-code":l.state.code,"read-only":!!l.state.script.config.removed,onClose:t[9]||(t[9]=e=>l.handleEditScript())},null,8,["initial","initial-code","read-only"])):(0,O.kq)("",!0)],1024))]))],512)}]]),to=eo,no=["data-show-advanced"],lo=["textContent"],ao={class:"mb-1c"},oo=["textContent"],io={class:"ml-2c flex flex-col"},so=["textContent"],ro={class:"ml-2c"},co=["onUpdate:modelValue"],uo=["value","textContent"],po=["onUpdate:modelValue"],mo=["value","textContent"],go=["textContent"],ho=["onUpdate:modelValue"],vo=["value","textContent"],fo=["textContent"],wo=["onUpdate:modelValue"],bo=["textContent"],yo={class:"mb-1c"},xo=["textContent"],Co={class:"ml-2c flex flex-col"},_o={class:"ml-2c flex flex-col"},ko={class:"mb-2c"},So=["textContent"],Uo=(0,O._)("hr",null,null,-1),zo=["open"],Do=["onClick"],$o={class:"mb-1c"},Ro=["textContent"],jo=["onUpdate:modelValue"],Ho=["value","textContent"],Eo={class:"ml-2c flex flex-col"},Io=["textContent"],Wo=["onUpdate:modelValue"],To=["textContent"],Oo=["textContent"],Mo=(0,O._)("code",null,"page",-1),Ao=["textContent"],Vo={key:0},Fo=(0,O._)("code",null,"page",-1),Lo=["textContent"],Po=["href"],Zo=["textContent"],Yo=["textContent"],No=["innerHTML"];var Bo=U(3657),qo=U(2274);const Ko=(0,U(4288).HP)(async()=>{await("/public/lib/zip-no-worker.min.js",new d((e,t)=>{const n=document.createElement("script");n.src="/public/lib/zip-no-worker.min.js",n.onload=e,n.onerror=t,document.body.append(n)}));const{zip:e}=t,n=["/public/lib/z-worker.js"];return e.configure({workerScripts:{deflate:n,inflate:n}}),e}),Jo=["textContent","disabled"],Go=["textContent","title"],Xo={class:"mt-1"},Qo=(0,O._)("br",null,null,-1),ei={class:"import-report"},ti=["data-type"],ni=["textContent"],li=["textContent","colspan"],ai={__name:"vm-import",setup(e){const t=(0,E.qj)([]),n=(0,E.iH)(),l=(0,E.iH)(""),a=(0,z.ag)("confirmUndoImport"),o=(0,z.ag)("labelImportScriptData"),i=(0,z.ag)("labelImportSettings");let r;function c(){const e=document.createElement("input");e.type="file",e.accept=".zip",e.onchange=()=>{var t;return h(null==(t=e.files)?void 0:t[0])},e.click()}async function h(e){if(!W.importing)try{await(W.importing=v(e))}finally{W.importing=null}}async function v(e){if(!e)return;t.length=0;const n=R.Z.get("importScriptData"),a=await Ko(),o=new a.ZipReader(new a.BlobReader(e)),i=await o.getEntries().catch(k)||[];if(t.length)return;k("",e.name,"info");const c={},p=i.reduce((e,t)=>{var n;return e+(null==(n=t.filename)?void 0:n.endsWith(".user.js"))},0),m=i.find(e=>{var t;return"violentmonkey"===(null==(t=e.filename)?void 0:t.toLowerCase())}),h=m&&await _(m)||{},v=R.Z.get("importSettings")&&h.settings,f=h.scripts||{},b=h.values||{};let y;function x(e,t){try{return JSON.parse(e)}catch(e){k(e,t.filename,null)}}function C(e,t){return d.all(i.map(async n=>{const{filename:l}=n;if(null!=l&&l.endsWith(t)){const a=await _(n);return a&&e(n,a,l.slice(0,-t.length))}}))}async function _(e){const t=await e.getData(new a.TextWriter);return e.filename.endsWith(".js")?t:x(t,e)}function k(e,n,l="critical"){t.push({text:e,name:n,type:l})}function S(e=""){const n=u.keys(c).length,l=(0,z.ag)("msgImported",[n===p?n:`${n} / ${p}`]);return t[0].name=l,t[0].text=e,l}function U(e){return(0,z.rY)(e).filter(e=>"string"==typeof e)}r||(y=" \u2bc8 "+(new Date).toLocaleTimeString(),r=g.runtime.connect({name:"undoImport"}),await new d(w)),await C(async(e,n,l)=>{const{meta:a,settings:o={},options:i}=n;if(!a||!i)return;const s=i.override||{};t[0].text="Tampermonkey",f[l]={config:{enabled:!1!==o.enabled?1:0,shouldUpdate:i.check_for_updates?1:0},custom:{downloadURL:"string"==typeof a.file_url?a.file_url:void 0,noframes:null==s.noframes?void 0:+!!s.noframes,runAt:Lt.qh.test(i.run_at)?i.run_at:void 0,exclude:U(s.use_excludes),include:U(s.use_includes),match:U(s.use_matches),origExclude:!1!==s.merge_excludes,origInclude:!1!==s.merge_includes,origMatch:!1!==s.merge_matches},position:+o.position||void 0,props:{lastModified:+a.modified,lastUpdated:+a.modified}}},".options.json"),await C(async(e,t,n)=>{var l,a,o,i;const{filename:s}=e,r=f[n],u={code:t,...r&&{custom:r.custom,config:{enabled:null!=(l=r.enabled)?l:1,shouldUpdate:null!=(a=r.update)?a:1,...r.config},position:r.position,props:{lastModified:r.lastModified||(null==(o=r.props)?void 0:o.lastModified)||+e.lastModDate,lastUpdated:r.lastUpdated||(null==(i=r.props)?void 0:i.lastUpdated)||+e.lastModDate}}};try{c[n]=(await(0,z.gj)("ParseScript",u)).update.props.uri,S(s)}catch(e){k(e,s,"script")}},".user.js"),n&&(await C(async(e,n,l)=>{t[0].text="Tampermonkey",b[c[l]]=n.data},".storage.json"),(0,z.gj)("SetValueStores",b)),s(v)&&(delete v.sync,(0,z.gj)("SetOptions",v)),(0,z.gj)("CheckPosition"),await o.close(),S(),y&&(l.value=y)}async function f(){await(0,j.GW)(a)&&(l.value="",r.postMessage(!0),await new d(w))}function w(e){r.onMessage.addListener(function t(){r.onMessage.removeListener(t),e()})}function b(e){let t;const n=t=>e.classList.toggle("drop-allowed",t),l=()=>n(!1),a=()=>{clearTimeout(t),t=setTimeout(l,250)},o=e=>{clearTimeout(t);const l=e.dataTransfer.types.includes("Files");l&&e.preventDefault(),n(l)},i=async e=>{e.preventDefault(),n(!1);const t=e.dataTransfer.files[0];await(0,j.GW)((0,z.ag)("buttonImportData"))&&await h(t)};return()=>{const e=W.route.hash===C?p:m;e("dragend",l),e("dragleave",a),e("dragover",o),e("drop",i)}}return(0,O.bv)(()=>{const e=b(n.value);p("hashchange",e),e()}),(e,s)=>((0,O.wg)(),(0,O.iD)("div",null,[(0,O._)("button",{textContent:(0,M.zw)((0,E.SU)(z.ag)("buttonImportData")),onClick:c,ref_key:"buttonImport",ref:n,disabled:(0,E.SU)(W).importing},null,8,Jo),l.value?((0,O.wg)(),(0,O.iD)("button",{key:0,textContent:(0,M.zw)((0,E.SU)(z.ag)("buttonUndo")+l.value),onClick:f,class:"has-error",title:(0,E.SU)(a)},null,8,Go)):(0,O.kq)("",!0),(0,O._)("div",Xo,[(0,O.Wm)((0,E.SU)(Ce.Z),{name:"importScriptData",label:(0,E.SU)(o)},null,8,["label"]),Qo,(0,O.Wm)((0,E.SU)(Ce.Z),{name:"importSettings",label:(0,E.SU)(i)},null,8,["label"])]),(0,O._)("table",ei,[((0,O.wg)(!0),(0,O.iD)(O.HY,null,(0,O.Ko)(t,({type:e,name:t,text:n},l)=>((0,O.wg)(),(0,O.iD)("tr",{key:l,"data-type":e},[t?((0,O.wg)(),(0,O.iD)("td",{key:0,textContent:(0,M.zw)(t)},null,8,ni)):(0,O.kq)("",!0),(0,O._)("td",{textContent:(0,M.zw)(n),colspan:t?null:2},null,8,li)],8,ti))),128))])]))}},oi=ai;var ii=U(950),si=U(4460),ri=U(3557);const ci=(0,z.ag)("msgDateFormatInfo",u.keys(si.q).join(", ")),ui={__name:"vm-date-info",setup:e=>(e,t)=>((0,O.wg)(),(0,O.j4)((0,E.SU)(xe.Z),{content:(0,E.SU)(ci),placement:"left",style:{"vertical-align":"middle"}},{default:(0,O.w5)(()=>[(0,O._)("a",{href:"https://momentjs.com/docs/#/displaying/format/",target:"_blank"},[(0,O.Wm)((0,E.SU)(_e.Z),{name:"info"})])]),_:1},8,["content"]))},di={class:"export"},pi={class:"flex flex-wrap center-items mr-1c"},mi=["textContent","disabled"],gi=["textContent"],hi={class:"mt-1"},vi={class:"modal-content"},fi=["download","href"],wi=(0,O._)("br",null,null,-1),bi=(0,O._)("strong",null,"scripts.zip",-1),yi={__name:"vm-export",setup(e){let t;const n=(0,E.iH)(),l=(0,E.iH)(!1),a=(0,E.iH)(b&&{}),o=(0,O.Fl)(()=>{const e=n.value;return e&&`${(0,si.p)(e.text.trim()||e.defaultValue)}.zip`});async function i(){try{l.value=!0,b&&!t&&(t=await(0,z.gj)("UA")),s(await c())}finally{l.value=!1}}function s(e){const n=b&&parseFloat(t.version),l=o.value;if(n&&("win"===t.os?n<56:"mac"===t.os?n<61:n<63)){const t=new FileReader;t.onload=()=>{a.value={name:l,url:t.result}},t.readAsDataURL(e)}else(0,ri.l)(e,l)}function r(e){return e.replace(/[\\/:*?"<>|]/g,"-")}async function c(){const e=R.Z.get("exportValues"),t=await(0,z.gj)("ExportZip",{values:e}),n={},l={scripts:{},settings:R.Z.get()};delete l.settings.sync,e&&(l.values={});const a=((0,be._M)(t,"items")||[]).map(({script:a,code:o})=>{let i=r((0,z.pV)(a));n[i]?(n[i]+=1,i=`${i}_${n[i]}`):n[i]=1;const{lastModified:s,lastUpdated:c}=a.props,u={custom:a.custom,config:a.config,position:a.props.position,lastModified:s,lastUpdated:c};if(e){const e=t.values[a.props.id];e&&(l.values[a.props.uri]=e)}return l.scripts[i]=u,{name:`${i}.user.js`,content:o,lastModDate:new Date(c||s)}});a.push({name:"violentmonkey",content:JSON.stringify(l,null,2)});const o=await Ko(),i=new o.BlobWriter("application/zip"),s=new o.ZipWriter(i,{bufferedWrite:!0,keepOrder:!1});return await d.all(a.map(e=>s.add(e.name,new o.TextReader(e.content),{lastModDate:e.lastModDate}))),await s.close()}return(e,t)=>((0,O.wg)(),(0,O.iD)("div",di,[(0,O._)("div",pi,[(0,O._)("button",{textContent:(0,M.zw)(e.i18n("buttonExportData")),onClick:i,disabled:l.value},null,8,mi),(0,O.Wm)((0,E.SU)(qo.Z),{name:"exportNameTemplate",ref_key:"tpl",ref:n,"has-reset":"","has-save":!1,rows:1,class:"tpl flex flex-1 center-items ml-1c"},null,512),(0,O.Wm)((0,E.SU)(ui)),(0,O._)("span",{hidden:"",textContent:(0,M.zw)(o.value)},null,8,gi)]),(0,O._)("div",hi,[(0,O.Wm)((0,E.SU)(Ce.Z),{name:"exportValues",label:e.i18n("labelExportScriptData")},null,8,["label"])]),a.value?((0,O.wg)(),(0,O.j4)((0,E.SU)(ii.Z),{key:0,transition:"in-out",show:!!a.value.url,onClose:t[0]||(t[0]=e=>a.value={})},{default:(0,O.w5)(()=>[(0,O._)("div",vi,[(0,O._)("a",{download:a.value.name,href:a.value.url},[(0,O.Uk)(" Right click and save as"),wi,bi],8,fi)])]),_:1},8,["show"])):(0,O.kq)("",!0)]))}},xi=yi,Ci={class:"mr-1c"},_i=["disabled","textContent"],ki=["disabled","textContent"],Si=["disabled","title","textContent"],Ui={__name:"vm-maintenance",setup(e){const t=(0,E.iH)((0,z.ag)("buttonVacuum")),n=(0,z.ag)("removeAllScriptsConfirm").replace(/\n+/,"\n\n"),l=(0,z.ag)("buttonResetSettings"),a=(0,E.iH)(!1),o=(0,E.iH)(""),i=(0,E.iH)(l);function s(e){a.value=e,W.importing=e||null}async function r(e,t){if(await(0,j.GW)(t,{ok:{className:"has-error"}}))try{s(!0),await e()}finally{s(!1)}}async function c(){await d.all(W.scripts.map(e=>T(e,!0))),W.scripts=[]}function p(){const e=["lastModified","lastUpdate","sync"],t=w(be.Xw,Bo.Z,null,(t,n)=>!e.includes(t)&&!(0,be.vZ)(n,R.Z.get(t))&&t);return o.value=JSON.stringify(t,null,2).slice(1,-1).replace(/^\s{2}/gm,""),i.value=`${l} (${u.keys(t).length})`,(0,z.gj)("SetOptions",t)}async function m(){s(!0),t.value=(0,z.ag)("buttonVacuuming");const{fixes:e,errors:n}=await(0,z.gj)("Vacuum"),l=null==n?void 0:n.join("\n");s(!1),t.value=(0,z.ag)("buttonVacuumed")+(e?` (${e})`:""),l&&(0,j.GW)((0,z.ag)("msgErrorFetchingResource")+"\n\n"+l,{cancel:!1})}return(e,s)=>((0,O.wg)(),(0,O.iD)("div",Ci,[(0,O.Wm)((0,E.SU)(xe.Z),{content:(0,E.SU)(z.ag)("hintVacuum")},{default:(0,O.w5)(()=>[(0,O._)("button",{onClick:m,disabled:a.value,textContent:(0,M.zw)(t.value)},null,8,_i)]),_:1},8,["content"]),(0,O._)("button",{onClick:s[0]||(s[0]=e=>r(c,(0,E.SU)(n))),disabled:a.value||!(0,E.SU)(W).scripts.length,textContent:(0,M.zw)((0,E.SU)(z.ag)("removeAllScripts"))},null,8,ki),(0,O._)("button",{onClick:s[1]||(s[1]=e=>r(p,(0,E.SU)(l))),disabled:a.value,title:o.value,textContent:(0,M.zw)(i.value)},null,8,Si)]))}},zi={class:"mb-1c"},Di=["textContent"],$i={key:0,class:"flex flex-wrap center-items"},Ri=["textContent"],ji=["value"],Hi=["textContent","value"],Ei=["textContent","disabled"],Ii=["disabled"],Wi=["textContent"],Ti={key:1,class:"mt-1c"},Oi={class:"sync-server-url"},Mi=["textContent"],Ai=["disabled"],Vi={class:"mr-2c"},Fi=["textContent"],Li=["disabled"],Pi={class:"inline-block"},Zi=["textContent"],Yi=["disabled"],Ni=["disabled"],Bi=["textContent"],qi=["textContent","disabled"],Ki={key:2},Ji="sync.current",Gi={current:""};(0,we.Z)(Ji,e=>{Gi.current=e||""});const Xi={components:{SettingCheck:Ce.Z,Icon:_e.Z,Tooltip:xe.Z},data:()=>({syncConfig:Gi,store:W}),computed:{syncServices(){const e=this.store.sync;return e&&e.length?[{displayName:this.i18n("labelSyncDisabled"),name:"",properties:{}},...e]:null},service(){if(this.syncServices){const e=this.syncConfig.current||"";let t=this.syncServices.find(t=>t.name===e);return t||(console.warn("Invalid current service:",e),t=this.syncServices[0]),t}return null},state(){const{service:e}=this;if(e){const t=["idle","error"].includes(e.syncState)&&["no-auth","unauthorized","error","authorized"].includes(e.authState),n=t&&"authorized"===e.authState;return{message:this.getMessage(),label:this.getLabel(),canAuthorize:t,canSync:n,authType:e.properties.authType,userConfig:e.userConfig||{}}}return null}},methods:{onSaveUserConfig(){(0,z.gj)("SyncSetConfig",this.state.userConfig)},onSyncChange(e){const{value:t}=e.target;R.Z.set(Ji,t)},onAuthorize(){const{service:e}=this;["authorized"].includes(e.authState)?(0,z.gj)("SyncRevoke"):["no-auth","unauthorized","error"].includes(e.authState)&&(0,z.gj)("SyncAuthorize")},onSync(){(0,z.gj)("SyncStart")},getMessage(){const{service:e}=this;if("initializing"===e.authState)return this.i18n("msgSyncInit");if("no-auth"===e.authState)return this.i18n("msgSyncNoAuthYet");if("error"===e.authState)return this.i18n("msgSyncInitError");if("unauthorized"===e.authState)return this.i18n("msgSyncInitError");if("error"===e.syncState)return this.i18n("msgSyncError");if("ready"===e.syncState)return this.i18n("msgSyncReady");if("syncing"===e.syncState){let t="";return e.progress&&e.progress.total&&(t=` (${e.progress.finished}/${e.progress.total})`),this.i18n("msgSyncing")+t}if(e.lastSync){const t=new Date(e.lastSync).toLocaleString();return this.i18n("lastSync",t)}},getLabel(){const{service:e}=this;return"authorizing"===e.authState?this.i18n("labelSyncAuthorizing"):"authorized"===e.authState?this.i18n("labelSyncRevoke"):this.i18n("labelSyncAuthorize")}}},Qi=(0,Ot.Z)(Xi,[["render",(e,t,n,l,a,o)=>{var i,s;const r=(0,O.up)("icon"),c=(0,O.up)("tooltip"),u=(0,O.up)("setting-check");return(0,O.wg)(),(0,O.iD)("section",zi,[(0,O._)("h3",{textContent:(0,M.zw)(e.i18n("labelSync"))},null,8,Di),o.state?((0,O.wg)(),(0,O.iD)("div",$i,[(0,O._)("span",{textContent:(0,M.zw)(e.i18n("labelSyncService"))},null,8,Ri),(0,O._)("select",{class:"mx-1",value:a.syncConfig.current,onChange:t[0]||(t[0]=(...e)=>o.onSyncChange&&o.onSyncChange(...e))},[((0,O.wg)(!0),(0,O.iD)(O.HY,null,(0,O.Ko)(o.syncServices,e=>((0,O.wg)(),(0,O.iD)("option",{key:e.name,textContent:(0,M.zw)(e.displayName),value:e.name},null,8,Hi))),128))],40,ji),o.service.name&&"oauth"===o.state.authType?((0,O.wg)(),(0,O.iD)("button",{key:0,textContent:(0,M.zw)(o.state.label),disabled:!o.state.canAuthorize,onClick:t[1]||(t[1]=(...e)=>o.onAuthorize&&o.onAuthorize(...e))},null,8,Ei)):(0,O.kq)("",!0),o.service.name?((0,O.wg)(),(0,O.j4)(c,{key:1,content:e.i18n("labelSync"),class:"stretch-self flex mr-1"},{default:(0,O.w5)(()=>[(0,O._)("button",{disabled:!o.state.canSync,onClick:t[2]||(t[2]=(...e)=>o.onSync&&o.onSync(...e)),class:"flex center-items"},[(0,O.Wm)(r,{name:"refresh"})],8,Ii)]),_:1},8,["content"])):(0,O.kq)("",!0),o.state?((0,O.wg)(),(0,O.iD)("p",{key:2,textContent:(0,M.zw)(o.state.message)},null,8,Wi)):(0,O.kq)("",!0)])):(0,O.kq)("",!0),"password"===(null==(i=o.state)?void 0:i.authType)?((0,O.wg)(),(0,O.iD)("fieldset",Ti,[(0,O._)("label",Oi,[(0,O._)("span",{textContent:(0,M.zw)(e.i18n("labelSyncServerUrl"))},null,8,Mi),(0,O.wy)((0,O._)("input",{type:"url","onUpdate:modelValue":t[3]||(t[3]=e=>o.state.userConfig.serverUrl=e),disabled:!o.state.canAuthorize},null,8,Ai),[[B.nr,o.state.userConfig.serverUrl]])]),(0,O._)("div",Vi,[(0,O._)("label",null,[(0,O._)("span",{textContent:(0,M.zw)(e.i18n("labelSyncUsername"))},null,8,Fi),(0,O.wy)((0,O._)("input",{type:"text","onUpdate:modelValue":t[4]||(t[4]=e=>o.state.userConfig.username=e),disabled:!o.state.canAuthorize||o.state.userConfig.anonymous},null,8,Li),[[B.nr,o.state.userConfig.username]])]),(0,O._)("label",Pi,[(0,O._)("span",{textContent:(0,M.zw)(e.i18n("labelSyncPassword"))},null,8,Zi),(0,O.wy)((0,O._)("input",{type:"password","onUpdate:modelValue":t[5]||(t[5]=e=>o.state.userConfig.password=e),disabled:!o.state.canAuthorize||o.state.userConfig.anonymous},null,8,Yi),[[B.nr,o.state.userConfig.password]])]),(0,O._)("label",null,[(0,O.wy)((0,O._)("input",{type:"checkbox","onUpdate:modelValue":t[6]||(t[6]=e=>o.state.userConfig.anonymous=e),disabled:!o.state.canAuthorize},null,8,Ni),[[B.e8,o.state.userConfig.anonymous]]),(0,O._)("span",{textContent:(0,M.zw)(e.i18n("labelSyncAnonymous"))},null,8,Bi)])]),(0,O._)("div",null,[(0,O._)("button",{textContent:(0,M.zw)(e.i18n("buttonSave")),onClick:t[7]||(t[7]=(0,B.iM)((...e)=>o.onSaveUserConfig&&o.onSaveUserConfig(...e),["prevent"])),disabled:!o.state.canAuthorize},null,8,qi)])])):(0,O.kq)("",!0),null!=(s=o.service)&&s.name?((0,O.wg)(),(0,O.iD)("div",Ki,[(0,O.Wm)(u,{name:"syncScriptStatus",label:e.i18n("labelSyncScriptStatus")},null,8,["label"])])):(0,O.kq)("",!0)])}]]),es=["textContent"],ts={class:"mr-1c flex center-items"},ns=["textContent"],ls=["disabled","title"],as=["value","textContent"],os=["textContent"],is=["textContent"],ss=["href"],rs=["textContent"],cs=["innerHTML"],us=["textContent"],ds=["textContent"],ps="editorTheme",ms="editorThemeName",gs=["3024-day","3024-night","abbott","abcdef","ambiance-mobile","ambiance","ayu-dark","ayu-mirage","base16-dark","base16-light","bespin","blackboard","cobalt","colorforth","darcula","dracula","duotone-dark","duotone-light","eclipse","elegant","erlang-dark","gruvbox-dark","hopscotch","icecoder","idea","isotope","juejin","lesser-dark","liquibyte","lucario","material-darker","material-ocean","material-palenight","material","mbo","mdn-like","midnight","monokai","moxer","neat","neo","night","nord","oceanic-next","panda-syntax","paraiso-dark","paraiso-light","pastel-on-dark","railscasts","rubyblue","seti","shadowfox","solarized","ssms","the-matrix","tomorrow-night-bright","tomorrow-night-eighties","ttcn","twilight","vibrant-ink","xq-dark","xq-light","yeti","yonce","zenburn"],hs="codemirror/CodeMirror",vs="master",fs="theme",ws=`https://github.com/${hs}/tree/${vs}/${fs}`,bs="default",ys=e=>e?e.split("\n",21).map((e,t)=>(20===t?"...":e.length>100&&`${e.slice(0,100)}...`)||e).join("\n"):null,xs={data:()=>({hint:null,busy:!1,error:null,css:null,theme:null,themes:gs,DEFAULT:bs,ghURL:ws}),components:{SettingText:qo.Z},beforeUnmount(){this.revokers.forEach(e=>e()),this.revokers=null},async mounted(){this.revokers||(this.css=ys(R.Z.get(ps)),this.revokers=[(0,we.Z)(ms,e=>{this.theme=null!=e?e:bs})],await R.Z.ready,this.$watch("theme",async e=>{const t=e&&e!==bs&&`https://raw.githubusercontent.com/${hs}/${vs}/${fs}/${e}.css`,n=t&&await this.fetch(t);R.Z.set(ms,!t||n?e:bs),R.Z.set(ps,n||""),this.css=ys(n)}))},methods:{async fetch(e,t="text"){const n=document.activeElement;this.busy=!0;try{const n=await(await fetch(e))[t]();return this.error=null,n}catch(e){this.error=e.message||e.code||`${e}`}finally{this.busy=!1,this.$nextTick(()=>null==n?void 0:n.focus())}},toggleBoolean(e){const t=e.target,{selectionStart:n,selectionEnd:l,value:a}=t,o=l&&{false:"true",true:"false"}[a.slice(n,l)];o&&!document.execCommand("insertText",!1,o)&&(t.value=a.slice(0,n)+o+a.slice(l),t.setSelectionRange(n+o.length,n+o.length),t.dispatchEvent(new Event("input")),t.onblur=()=>t.dispatchEvent(new Event("change")))},async toggleStateHint(){if(this.hint)return void(this.hint=null);const e=["mode","value","configureMouse","lineNumberFormatter","specialCharPlaceholder"],n={};u.entries({...(await d.resolve().then(U.t.bind(U,4631,23))).default.defaults,...(await d.resolve().then(U.bind(U,8599))).default.data().cmDefaults,...R.Z.get("editor")}).sort(([e],[t])=>e<t?-1:e>t).filter(([t,n])=>!e.includes(t)&&!i(n)).forEach(([e,t])=>{n[e]=t}),this.hint=JSON.stringify(n,null,"  "),setTimeout(()=>{this.$el.getBoundingClientRect().bottom>t.innerHeight&&this.$el.scrollIntoView({behavior:"smooth"})})}}},Cs=(0,Ot.Z)(xs,[["render",(e,t,n,l,a,o)=>{const i=(0,O.up)("setting-text");return(0,O.wg)(),(0,O.iD)("section",null,[(0,O._)("h3",{textContent:(0,M.zw)(e.i18n("labelEditor"))},null,8,es),(0,O._)("div",ts,[(0,O._)("span",{textContent:(0,M.zw)(e.i18n("labelTheme"))},null,8,ns),(0,O.wy)((0,O._)("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>a.theme=e),disabled:a.busy,title:a.css},[(0,O._)("option",{value:a.DEFAULT,textContent:(0,M.zw)(e.i18n("labelRunAtDefault"))},null,8,as),(0,O._)("option",{value:"",textContent:(0,M.zw)(e.i18n("labelBadgeNone"))},null,8,os),((0,O.wg)(!0),(0,O.iD)(O.HY,null,(0,O.Ko)(a.themes,e=>((0,O.wg)(),(0,O.iD)("option",{key:e,textContent:(0,M.zw)(e)},null,8,is))),128))],8,ls),[[B.bM,a.theme]]),(0,O._)("a",{href:a.ghURL,target:"_blank"},"\u2197",8,ss),(0,O._)("p",{textContent:(0,M.zw)(a.error)},null,8,rs)]),(0,O._)("p",{innerHTML:e.i18n("descEditorOptions"),class:"my-1"},null,8,cs),(0,O.Wm)(i,{name:"editor",json:"","has-reset":"",onDblclick:o.toggleBoolean},{default:(0,O.w5)(()=>[(0,O._)("button",{textContent:(0,M.zw)(e.i18n("buttonShowEditorState")),onClick:t[1]||(t[1]=(...e)=>o.toggleStateHint&&o.toggleStateHint(...e))},null,8,us)]),_:1},8,["onDblclick"]),(0,O._)("pre",{textContent:(0,M.zw)(a.hint),class:"monospace-font dim-hint"},null,8,ds)])}]]),_s=["textContent"],ks=["textContent"],Ss={class:"flex flex-wrap"},Us={key:0,class:"text-red"},zs=["textContent"],Ds={components:{SettingText:qo.Z},data:()=>({errors:null}),async mounted(){this.errors=await(0,z.gj)("Storage",["base","getOne",Lt.BZ])}},$s=(0,Ot.Z)(Ds,[["render",(e,t,n,l,a,o)=>{const i=(0,O.up)("setting-text");return(0,O.wg)(),(0,O.iD)("section",null,[(0,O._)("h3",{textContent:(0,M.zw)(e.i18n("labelBlacklist"))},null,8,_s),(0,O._)("p",null,[(0,O.Uk)((0,M.zw)(e.i18n("descBlacklist"))+" ",1),(0,O._)("a",{href:"https://violentmonkey.github.io/posts/smart-rules-for-blacklist/#blacklist-patterns",target:"_blank",rel:"noopener noreferrer",textContent:(0,M.zw)(e.i18n("learnBlacklist"))},null,8,ks)]),(0,O._)("div",Ss,[(0,O.Wm)(i,{name:"blacklist",class:"flex-1",onBgError:t[0]||(t[0]=e=>a.errors=e)}),a.errors?((0,O.wg)(),(0,O.iD)("ol",Us,[((0,O.wg)(!0),(0,O.iD)(O.HY,null,(0,O.Ko)(a.errors,e=>((0,O.wg)(),(0,O.iD)("li",{key:e,textContent:(0,M.zw)(e)},null,8,zs))),128))])):(0,O.kq)("",!0)])])}]]),Rs={badgeColor:(0,z.ag)("titleBadgeColor"),badgeColorBlocked:(0,z.ag)("titleBadgeColorBlocked")},js=u.keys(Rs),Hs={enum:Rs,normalize:(e,t)=>/^#[0-9a-f]{6}$/i.test(e)?e:Bo.Z[t]},Es={autoUpdate:{normalize:e=>Math.max(0,Math.min(365,+e||0))},defaultInjectInto:{enum:Lt.Wg},showAdvanced:{normalize:e=>e},showBadge:{enum:{"":(0,z.ag)("labelBadgeNone"),unique:(0,z.ag)("labelBadgeUnique"),total:(0,z.ag)("labelBadgeTotal")}},"filtersPopup.hideDisabled":{enum:{"":(0,z.ag)("optionPopupShowDisabled"),group:(0,z.ag)("optionPopupGroupDisabled"),hide:(0,z.ag)("optionPopupHideDisabled")}},"filtersPopup.sort":{enum:{exec:(0,z.ag)("filterExecutionOrder"),alpha:(0,z.ag)("filterAlphabeticalOrder")}},uiTheme:{enum:{"":(0,z.ag)("optionUiThemeAuto"),dark:(0,z.ag)("optionUiThemeDark"),light:(0,z.ag)("optionUiThemeLight")}},xhrInject:{normalize:e=>e},...w(be.Xw,Rs,()=>Hs)},Is=(e,t)=>f(Es[t].enum,e)?e:u.keys(Es[t].enum)[0],Ws=(e,t)=>(0,z.Ds)((n,l)=>{(n=t(n,e))!==(l=t(l,e))&&R.Z.set(e,n)},50),Ts=(0,E.qj)({}),Os={components:{VmImport:oi,VmExport:xi,VmMaintenance:Ui,VmSync:Qi,VmEditor:Cs,VmBlacklist:$s,VmDateInfo:ui,SettingCheck:Ce.Z,SettingText:qo.Z,LocaleGroup:ke.Z,Tooltip:xe.Z},data:()=>({expose:null,items:Es,settings:Ts}),computed:{editorWindowHint(){var e;return null!=(e=g.windows)&&e.onBoundsChanged?null:this.i18n("optionEditorWindowHint")},isCustomBadgeColor:()=>js.some(e=>Ts[e]!==Bo.Z[e])},methods:{ctrlS(){document.activeElement.dispatchEvent(new Event("ctrl-s"))},onResetBadgeColors(){js.forEach(e=>{Ts[e]=Bo.Z[e]})}},activated(){(0,j.wO)(this.$el),this.revokers=[N.$J.register("ctrlcmd-s",this.ctrlS,{condition:"inputFocus"})],w(be.LI,Es,([e,{normalize:t=Is}])=>{this.revokers.push((0,we.Z)(e,n=>{Ts[e]=t(n,e)})),this.$watch(()=>Ts[e],Ws(e,t))}),this.expose=u.keys(R.Z.get(n)).map(e=>[e,decodeURIComponent(e)])},deactivated(){this.revokers.forEach(e=>{e()})}},Ms=(0,Ot.Z)(Os,[["render",(e,t,n,l,a,o)=>{var i;const s=(0,O.up)("setting-check"),r=(0,O.up)("tooltip"),c=(0,O.up)("locale-group"),u=(0,O.up)("vm-import"),d=(0,O.up)("vm-export"),p=(0,O.up)("vm-maintenance"),m=(0,O.up)("vm-sync"),g=(0,O.up)("vm-editor"),h=(0,O.up)("vm-date-info"),v=(0,O.up)("setting-text"),f=(0,O.up)("vm-blacklist");return(0,O.wg)(),(0,O.iD)("div",{class:"tab-settings","data-show-advanced":a.settings.showAdvanced},[(0,O._)("h1",{textContent:(0,M.zw)(e.i18n("labelSettings"))},null,8,lo),(0,O._)("section",ao,[(0,O._)("h3",{textContent:(0,M.zw)(e.i18n("optionPopup"))},null,8,oo),(0,O._)("div",null,[(0,O.Wm)(s,{name:"autoReload",label:e.i18n("labelAutoReloadCurrentTab")},null,8,["label"])]),(0,O._)("div",io,[(0,O.Wm)(s,{name:"editorWindow",class:"mr-2",ref:"EW"},{default:(0,O.w5)(()=>[(0,O.Wm)(r,{content:o.editorWindowHint,disabled:!o.editorWindowHint},{default:(0,O.w5)(()=>[(0,O._)("span",{textContent:(0,M.zw)(e.i18n("optionEditorWindow"))},null,8,so)]),_:1},8,["content","disabled"])]),_:1},512),(0,O.wy)((0,O.Wm)(s,{name:"editorWindowSimple",label:e.i18n("optionEditorWindowSimple")},null,8,["label"]),[[B.F8,null==(i=e.$refs.EW)?void 0:i.value]])]),(0,O._)("div",ro,[(0,O._)("label",null,[(0,O.Wm)(c,{"i18n-key":"labelPopupSort"},{default:(0,O.w5)(()=>[((0,O.wg)(!0),(0,O.iD)(O.HY,null,(0,O.Ko)(["filtersPopup.sort"],e=>(0,O.wy)(((0,O.wg)(),(0,O.iD)("select",{"onUpdate:modelValue":t=>a.settings[e]=t,key:e},[((0,O.wg)(!0),(0,O.iD)(O.HY,null,(0,O.Ko)(a.items[e].enum,(t,n)=>((0,O.wg)(),(0,O.iD)("option",{key:`${e}:${n}`,value:n,textContent:(0,M.zw)(t)},null,8,uo))),128))],8,co)),[[B.bM,a.settings[e]]])),128))]),_:1})]),(0,O.wy)((0,O.Wm)(s,{name:"filtersPopup.groupRunAt",label:e.i18n("optionPopupGroupRunAt")},null,8,["label"]),[[B.F8,"exec"===a.settings["filtersPopup.sort"]]]),(0,O._)("label",null,[((0,O.wg)(!0),(0,O.iD)(O.HY,null,(0,O.Ko)(["filtersPopup.hideDisabled"],e=>(0,O.wy)(((0,O.wg)(),(0,O.iD)("select",{"onUpdate:modelValue":t=>a.settings[e]=t,key:e},[((0,O.wg)(!0),(0,O.iD)(O.HY,null,(0,O.Ko)(a.items[e].enum,(t,n)=>((0,O.wg)(),(0,O.iD)("option",{key:`${e}:${n}`,value:n,textContent:(0,M.zw)(t)},null,8,mo))),128))],8,po)),[[B.bM,a.settings[e]]])),128))]),(0,O.wy)((0,O.Wm)(s,{name:"filtersPopup.enabledFirst",label:e.i18n("optionPopupEnabledFirst")},null,8,["label"]),[[B.F8,!a.settings["filtersPopup.hideDisabled"]]])]),(0,O._)("div",null,[(0,O._)("label",null,[(0,O._)("span",{textContent:(0,M.zw)(e.i18n("labelBadge"))},null,8,go),((0,O.wg)(),(0,O.iD)(O.HY,null,(0,O.Ko)(["showBadge"],e=>(0,O.wy)((0,O._)("select",{"onUpdate:modelValue":t=>a.settings[e]=t,key:e},[((0,O.wg)(!0),(0,O.iD)(O.HY,null,(0,O.Ko)(a.items[e].enum,(t,n)=>((0,O.wg)(),(0,O.iD)("option",{key:`${e}:${n}`,value:n,textContent:(0,M.zw)(t)},null,8,vo))),128))],8,ho),[[B.bM,a.settings[e]]])),64))])]),(0,O._)("div",null,[(0,O._)("label",null,[(0,O._)("span",{textContent:(0,M.zw)(e.i18n("labelBadgeColors"))},null,8,fo),((0,O.wg)(!0),(0,O.iD)(O.HY,null,(0,O.Ko)(a.items.badgeColor.enum,(e,t)=>((0,O.wg)(),(0,O.j4)(r,{key:`bc:${t}`,content:e},{default:(0,O.w5)(()=>[(0,O.wy)((0,O._)("input",{type:"color","onUpdate:modelValue":e=>a.settings[t]=e},null,8,wo),[[B.nr,a.settings[t]]])]),_:2},1032,["content"]))),128)),(0,O.wy)((0,O._)("button",{textContent:(0,M.zw)(e.i18n("buttonReset")),class:"ml-1",onClick:t[0]||(t[0]=(...e)=>o.onResetBadgeColors&&o.onResetBadgeColors(...e))},null,8,bo),[[B.F8,o.isCustomBadgeColor]])])])]),(0,O._)("section",yo,[(0,O._)("h3",{textContent:(0,M.zw)(e.i18n("optionUpdate"))},null,8,xo),(0,O._)("div",Co,[(0,O._)("label",null,[(0,O.Wm)(c,{"i18n-key":"labelAutoUpdate"},{default:(0,O.w5)(()=>[(0,O.wy)((0,O._)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>a.settings.autoUpdate=e),type:"number",min:"0",max:"365",step:"1/"},null,512),[[B.nr,a.settings.autoUpdate]])]),_:1})]),(0,O.Wm)(s,{name:"updateEnabledScriptsOnly",label:e.i18n("labelEnabledScriptsOnly")},null,8,["label"])]),(0,O._)("div",_o,[(0,O.Wm)(s,{name:"notifyUpdates",label:e.i18n("labelNotifyUpdates")},null,8,["label"]),(0,O.Wm)(s,{name:"notifyUpdatesGlobal",label:e.i18n("labelNotifyUpdatesGlobal"),class:"ml-2"},null,8,["label"])])]),(0,O._)("section",ko,[(0,O._)("h3",{textContent:(0,M.zw)(e.i18n("labelBackupMaintenance"))},null,8,So),(0,O.Wm)(u),(0,O.Wm)(d),Uo,(0,O.Wm)(p)]),(0,O.Wm)(m),((0,O.wg)(!0),(0,O.iD)(O.HY,null,(0,O.Ko)({showAdvanced:a.settings},(t,n)=>((0,O.wg)(),(0,O.iD)("details",{key:n,open:t[n]},[(0,O._)("summary",{onClick:(0,B.iM)(e=>t[n]=!t[n],["prevent"])},[((0,O.wg)(),(0,O.j4)((0,O.LL)(t[n]?"h1":"h3"),{textContent:(0,M.zw)(e.i18n("labelAdvanced")),class:"inline-block"},null,8,["textContent"]))],8,Do),(0,O._)("section",$o,[(0,O._)("h3",{textContent:(0,M.zw)(e.i18n("labelGeneral"))},null,8,Ro),(0,O._)("div",null,[(0,O._)("label",null,[(0,O.Wm)(c,{"i18n-key":"optionUiTheme"},{default:(0,O.w5)(()=>[((0,O.wg)(),(0,O.iD)(O.HY,null,(0,O.Ko)(["uiTheme"],e=>(0,O.wy)((0,O._)("select",{"onUpdate:modelValue":t=>a.settings[e]=t,key:e},[((0,O.wg)(!0),(0,O.iD)(O.HY,null,(0,O.Ko)(a.items[e].enum,(e,t)=>((0,O.wg)(),(0,O.iD)("option",{key:t,value:t,textContent:(0,M.zw)(e)},null,8,Ho))),128))],8,jo),[[B.bM,a.settings[e]]])),64))]),_:1})])]),(0,O._)("div",Eo,[(0,O._)("label",null,[(0,O._)("span",{textContent:(0,M.zw)(e.i18n("labelInjectionMode"))},null,8,Io),((0,O.wg)(),(0,O.iD)(O.HY,null,(0,O.Ko)(["defaultInjectInto"],e=>(0,O.wy)((0,O._)("select",{"onUpdate:modelValue":t=>a.settings[e]=t,key:e},[((0,O.wg)(!0),(0,O.iD)(O.HY,null,(0,O.Ko)(a.items[e].enum,(e,t)=>((0,O.wg)(),(0,O.iD)("option",{key:t,textContent:(0,M.zw)(t)},null,8,To))),128))],8,Wo),[[B.bM,a.settings[e]]])),64)),(0,O._)("a",{class:"ml-1",href:"https://violentmonkey.github.io/posts/inject-into-context/",target:"_blank",rel:"noopener noreferrer",textContent:(0,M.zw)(e.i18n("learnInjectionMode"))},null,8,Oo)]),(0,O.Wm)(r,{content:e.i18n("labelXhrInjectHint")},{default:(0,O.w5)(()=>[(0,O.Wm)(s,{name:"xhrInject"},{default:(0,O.w5)(()=>[(0,O.Wm)(c,{"i18n-key":"labelXhrInject"},{default:(0,O.w5)(()=>[Mo]),_:1}),(0,O.Uk)(),(0,O._)("ruby",{textContent:(0,M.zw)(e.i18n("labelXhrInjectNote"))},null,8,Ao)]),_:1})]),_:1},8,["content"]),a.settings.xhrInject?(0,O.kq)("",!0):((0,O.wg)(),(0,O.iD)("label",Vo,[(0,O.Wm)(s,{name:"ffInject"}),(0,O.Wm)(r,{content:e.i18n("labelFastFirefoxInjectHint")},{default:(0,O.w5)(()=>[(0,O.Wm)(c,{"i18n-key":"labelFastFirefoxInject"},{default:(0,O.w5)(()=>[Fo]),_:1})]),_:1},8,["content"])]))]),(0,O._)("div",null,[(0,O.Wm)(c,{"i18n-key":"labelExposeStatus",class:"flex flex-col"},{default:(0,O.w5)(()=>[((0,O.wg)(!0),(0,O.iD)(O.HY,null,(0,O.Ko)(a.expose,([e,t])=>((0,O.wg)(),(0,O.j4)(s,{key:t,name:`expose.${e}`,class:"ml-2 mr-1c valign-tb"},{default:(0,O.w5)(()=>[(0,O._)("span",{textContent:(0,M.zw)(t)},null,8,Lo),(0,O._)("a",{href:`https://${t}`,target:"_blank",rel:"noopener noreferrer"},"\u2197",8,Po)]),_:2},1032,["name"]))),128))]),_:2},1024)]),(0,O.Wm)(s,{name:"helpForLocalFile",label:e.i18n("helpForLocalFile")},null,8,["label"])]),(0,O.Wm)(g),(0,O._)("section",null,[(0,O._)("h3",{textContent:(0,M.zw)(e.i18n("labelScriptTemplate"))},null,8,Zo),(0,O._)("p",null,[((0,O.wg)(!0),(0,O.iD)(O.HY,null,(0,O.Ko)(e.i18n("descScriptTemplate").split(/<(\S+?)>/),(e,t)=>((0,O.wg)(),(0,O.j4)((0,O.LL)(t%2?"code":"span"),{textContent:(0,M.zw)(e),key:t},null,8,["textContent"]))),128)),(0,O.Uk)(),(0,O.Wm)(h)]),(0,O.Wm)(v,{name:"scriptTemplate","has-reset":""})]),(0,O.Wm)(f),(0,O._)("section",null,[(0,O._)("h3",{textContent:(0,M.zw)(e.i18n("labelCustomCSS"))},null,8,Yo),(0,O._)("p",{innerHTML:e.i18n("descCustomCSS")},null,8,No),(0,O.Wm)(v,{name:"customCSS"})])],8,zo))),128))],8,no)}]]),As={class:"tab-about mb-2c"},Vs={class:"mt-0 mr-1c"},Fs=["textContent"],Ls=["textContent"],Ps=["textContent"],Zs=["textContent"],Ys=["textContent"],Ns=["textContent"],Bs=["textContent"],qs=["textContent"],Ks=["textContent"],Js=["textContent"],Gs=["textContent"],Xs={__name:"tab-about",setup(e){const t=x.name,n=browser.i18n.getUILanguage();return(e,l)=>((0,O.wg)(),(0,O.iD)("div",As,[(0,O._)("h1",Vs,[(0,O._)("span",{textContent:(0,M.zw)((0,E.SU)(t))},null,8,Fs),(0,O._)("small",{textContent:(0,M.zw)(`v${(0,E.SU)("2.18.0")}`)},null,8,Ls)]),(0,O._)("p",{textContent:(0,M.zw)(e.i18n("extDescription"))},null,8,Ps),(0,O._)("div",null,[(0,O._)("label",{textContent:(0,M.zw)(e.i18n("labelRelated"))},null,8,Zs),(0,O._)("ul",null,[(0,O._)("li",null,[(0,O._)("a",{href:"https://violentmonkey.github.io",target:"_blank",rel:"noopener noreferrer",textContent:(0,M.zw)(e.i18n("labelHomepage"))},null,8,Ys)]),(0,O._)("li",null,[(0,O._)("a",{href:"https://github.com/violentmonkey/violentmonkey/issues",target:"_blank",rel:"noopener noreferrer",textContent:(0,M.zw)(e.i18n("labelFeedback"))},null,8,Ns)]),(0,O._)("li",null,[(0,O._)("a",{href:"https://github.com/violentmonkey/violentmonkey/graphs/contributors",target:"_blank",rel:"noopener noreferrer",textContent:(0,M.zw)(e.i18n("labelContributors"))},null,8,Bs)]),(0,O._)("li",null,[(0,O._)("a",{href:"https://violentmonkey.github.io/privacy/",target:"_blank",rel:"noopener noreferrer",textContent:(0,M.zw)(e.i18n("labelPrivacyPolicy"))},null,8,qs)])])]),(0,O._)("div",null,[(0,O._)("label",{textContent:(0,M.zw)(e.i18n("labelCurrentLang"))},null,8,Ks),(0,O._)("span",{class:"current",textContent:(0,M.zw)((0,E.SU)(n))},null,8,Js),(0,O.Uk)(" | "),(0,O._)("a",{href:"https://violentmonkey.github.io/localization/",target:"_blank",rel:"noopener noreferrer",textContent:(0,M.zw)(e.i18n("labelHelpTranslate"))},null,8,Gs)])]))}},Qs=[{name:o,comp:to,label:(0,z.ag)("sideMenuInstalled")},{name:C,comp:Ms,label:(0,z.ag)("sideMenuSettings")},{name:_,comp:Xs,label:(0,z.ag)("sideMenuAbout")},{name:k,comp:to,label:(0,z.ag)("buttonRecycleBin")}],er=(0,z.ag)("extName"),tr="!editScript",nr=(0,O.Fl)(()=>{const e=W.route.paths[0];return Qs.find(t=>t.name===e)||Qs[0]}),lr=(0,O.Fl)(()=>({[o]:W.scripts.length,[k]:W.removedScripts.length}));function ar(){const e=nr.value.name===o,{paths:t}=W.route;N.$J.setContext("editScript",e&&t[1]),N.$J.setContext("tabScripts",e&&!t[1]),N.$J.setContext("showRecycle",nr.value.name===k)}function or(e){const n=Qs.indexOf(nr.value),l=Qs[(n+e+Qs.length)%Qs.length];t.location.hash=(null==l?void 0:l.name)||""}p("dragover",e=>{var t;W.route.hash!==C&&/^application\/(zip|x-zip-compressed)$/.test(null==(t=e.dataTransfer.items[0])?void 0:t.type)&&(location.hash=`#${C}`)},!0);const ir={setup(){const[e,t]=W.route.paths,n=(0,E.iH)(e!==o||"_new"!==t&&!Number(t));return(0,O.m0)(()=>{const{title:e}=W;document.title=e?`${e} - ${er}`:er}),(0,O.YP)(()=>W.route.paths,()=>{n.value=!0,ar()}),(0,O.bv)(()=>{const e=[N.$J.register("a-pageup",()=>or(-1),{condition:tr}),N.$J.register("a-pagedown",()=>or(1),{condition:tr})];return N.$J.enable(),ar(),()=>{e.forEach(e=>{e()}),N.$J.disable()}}),{tabs:Qs,current:nr,numbers:lr,canRenderAside:n}}},sr=(0,Ot.Z)(ir,[["render",(e,t,n,l,a,o)=>((0,O.wg)(),(0,O.iD)("div",A,[l.canRenderAside?((0,O.wg)(),(0,O.iD)("aside",V,[(0,O._)("div",F,[L,(0,O._)("h1",{class:"hidden-sm",textContent:(0,M.zw)(e.i18n("extName"))},null,8,P),Z,((0,O.wg)(!0),(0,O.iD)(O.HY,null,(0,O.Ko)(l.tabs,e=>((0,O.wg)(),(0,O.iD)("div",{class:"aside-menu-item",key:e.name},[(0,O._)("a",{href:`#${e.name}`,class:(0,M.C_)({active:e===l.current}),"data-num-scripts":l.numbers[e.name],textContent:(0,M.zw)(e.label)},null,10,Y)]))),128))])])):(0,O.kq)("",!0),((0,O.wg)(),(0,O.j4)(O.Ob,null,[((0,O.wg)(),(0,O.j4)((0,O.LL)(l.current.comp),{class:"tab"}))],1024))]))]]),rr=[(0,z.ag)("editNavCode"),(0,z.ag)("editNavSettings"),(0,z.ag)("editNavValues"),"@require","@resource"];let cr;function ur(e,t){const n=e.meta||{},l=(0,z.iQ)(n,"name"),a=w(z.Hv,[n.name,l,n.description,(0,z.iQ)(n,"description"),e.custom.name,e.custom.description],"\n"),o=e.custom.name||l,i=o.toLowerCase();let s=0,r="";t.forEach((e,t)=>{s+=e,e&&(r+=`${rr[t]}: ${(0,z.aj)(e)}\n`)}),e.$cache={search:a,name:o,lowerName:i,size:(0,z.aj)(s,!0).replace(" ",""),sizes:r.slice(0,-1).replace(/\x20/g,"\xa0").replace(/[^B]$/gm,"$&B"),sizeNum:s},e.$canUpdate=(0,z.TZ)(e)&&(e.config.shouldUpdate?1:-1),(0,$.d)(e,W,!0)}function dr(){const e=+W.route.paths[1];return pr(e?[e]:null).catch(e&&(()=>pr()))}async function pr(e){const[t]=await d.all([(0,z.gj)("GetData",{ids:e,sizes:!0},{retry:!0}),R.Z.ready]),{scripts:n,sizes:l,...a}=t;u.assign(W,a);const o=[],i=[];n.forEach((e,t)=>{ur(e,l[t]),(e.config.removed?i:o).push(e)}),W.scripts=o,W.removedScripts=i,W.loading=!1}W.loading=!0,dr(),u.assign(D.Z,{ScriptsUpdated(){dr()},UpdateSync(e){W.sync=e},async UpdateScript({update:e,where:t}={}){var n;if(!e)return;(cr||(cr=W.importing)&&(cr=d.race([cr,(0,z.dL)(500)])))&&(await cr,cr=null);const l=W.scripts.findIndex(e=>e.props.id===t.id),a=W.removedScripts.findIndex(e=>e.props.id===t.id),i=W.scripts[l]||W.removedScripts[a]||W.canRenderScripts&&{};if(!i)return;const[s]=await(0,z.gj)("GetSizes",[t.id]);if(u.assign(i,e),i.error&&!e.error&&(i.error=null),ur(i,s),null!=(null==(n=e.config)?void 0:n.removed)&&(e.config.removed?W.needRefresh=!0:W.removedScripts=W.removedScripts.filter(e=>e.props.id!==t.id)),(i.config.removed?a:l)<0){i.message="";const e=i.config.removed?"removedScripts":o;W[e]=[...W[e],i]}},RemoveScripts(e){W.removedScripts=W.removedScripts.filter(t=>!e.includes(t.props.id))}}),(0,j.sY)(sr)},6291:(e,t,n)=>{var l={"./arrow.svg":943,"./author.svg":7767,"./code.svg":4064,"./cog.svg":9640,"./command.svg":4507,"./filter.svg":5698,"./home.svg":7030,"./info.svg":6501,"./more.svg":8614,"./plus.svg":2996,"./question.svg":1902,"./refresh.svg":1694,"./search.svg":1112,"./toggle-off.svg":6817,"./toggle-on.svg":385,"./trash.svg":4289,"./undo.svg":8947};function a(e){var t=o(e);return n(t)}function o(e){if(!n.o(l,e)){var t=new c("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return l[e]}a.keys=()=>u.keys(l),a.resolve=o,e.exports=a,a.id=6291}},$={};function R(e){var t=$[e];if(void 0!==t)return t.exports;var n=$[e]={exports:{}};return D[e].call(n.exports,n,n.exports,R),n.exports}R.m=D,v=[],R.O=(e,t,n,l)=>{if(!t){var a=1/0;for(r=0;r<v.length;r++){for(var[t,n,l]=v[r],o=!0,i=0;i<t.length;i++)(!1&l||a>=l)&&u.keys(R.O).every(e=>R.O[e](t[i]))?t.splice(i--,1):(o=!1,l<a&&(a=l));if(o){v.splice(r--,1);var s=n();void 0!==s&&(e=s)}}return e}l=l||0;for(var r=v.length;r>0&&v[r-1][2]>l;r--)v[r]=v[r-1];v[r]=[t,n,l]},R.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return R.d(t,{a:t}),t},z=u.getPrototypeOf?e=>u.getPrototypeOf(e):e=>e.__proto__,R.t=function(e,t){if(1&t&&(e=this(e)),8&t)return e;if("object"==typeof e&&e){if(4&t&&e.__esModule)return e;if(16&t&&"function"==typeof e.then)return e}var n=u.create(null);R.r(n);var l={};U=U||[null,z({}),z([]),z(z)];for(var a=2&t&&e;"object"==typeof a&&!~U.indexOf(a);a=z(a))u.getOwnPropertyNames(a).forEach(t=>l[t]=()=>e[t]);return l.default=()=>e,R.d(n,l),n},R.d=(e,t)=>{for(var n in t)R.o(t,n)&&!R.o(e,n)&&u.defineProperty(e,n,{enumerable:!0,get:t[n]})},R.o=(e,t)=>u.prototype.hasOwnProperty.call(e,t),R.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&u.defineProperty(e,Symbol.toStringTag,{value:"Module"}),u.defineProperty(e,"__esModule",{value:!0})},R.j=360,(()=>{var e={360:0};R.O.j=t=>0===e[t];var t=(t,n)=>{var l,a,[o,i,s]=n,r=0;if(o.some(t=>0!==e[t])){for(l in i)R.o(i,l)&&(R.m[l]=i[l]);if(s)var c=s(R)}for(t&&t(n);r<o.length;r++)a=o[r],R.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return R.O(c)},n=self.webpackChunkviolentmonkey=self.webpackChunkviolentmonkey||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var j=R.O(void 0,[386,84],()=>R(766));j=R.O(j)})()}